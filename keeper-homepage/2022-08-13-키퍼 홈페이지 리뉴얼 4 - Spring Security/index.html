<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><meta data-react-helmet="true" name="description" content="오늘 동아리 회장 선거를 진행했는데, 동아리원들이 직접 만든 선거 페이지로 선거를 진행했습니다. 실시간 투표율부터, 투표 결과를 다이나믹한 애니메이션으로 보여줘서 너무 감격이었습니다. 감동 받은 김에 홈페이지 관련 글을 하나 더 써보려고 합니다!"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1.0"/><meta data-react-helmet="true" http-equiv="Content-Type" content="text/html;charset=UTF-8"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="키퍼 홈페이지 리뉴얼 4 - 개발 초기 환경 설정 (Spring Security)"/><meta data-react-helmet="true" property="og:description" content="오늘 동아리 회장 선거를 진행했는데, 동아리원들이 직접 만든 선거 페이지로 선거를 진행했습니다. 실시간 투표율부터, 투표 결과를 다이나믹한 애니메이션으로 보여줘서 너무 감격이었습니다. 감동 받은 김에 홈페이지 관련 글을 하나 더 써보려고 합니다!"/><meta data-react-helmet="true" property="og:image" content="/static/33cf44000cc00249062e2900f9449e18/SpringSecurity.png"/><meta data-react-helmet="true" property="og:url"/><meta data-react-helmet="true" property="og:site_name" content="키퍼 홈페이지 리뉴얼 4 - 개발 초기 환경 설정 (Spring Security)"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="키퍼 홈페이지 리뉴얼 4 - 개발 초기 환경 설정 (Spring Security)"/><meta data-react-helmet="true" name="twitter:description" content="오늘 동아리 회장 선거를 진행했는데, 동아리원들이 직접 만든 선거 페이지로 선거를 진행했습니다. 실시간 투표율부터, 투표 결과를 다이나믹한 애니메이션으로 보여줘서 너무 감격이었습니다. 감동 받은 김에 홈페이지 관련 글을 하나 더 써보려고 합니다!"/><meta data-react-helmet="true" name="twitter:image" content="/static/33cf44000cc00249062e2900f9449e18/SpringSecurity.png"/><meta data-react-helmet="true" name="twitter:site" content="@사용자이름"/><meta data-react-helmet="true" name="twitter:creator" content="@사용자이름"/><title data-react-helmet="true">키퍼 홈페이지 리뉴얼 4 - 개발 초기 환경 설정 (Spring Security)</title><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="canonical" href="https://gusah009.github.io/keeper-homepage/2022-08-13-키퍼%20홈페이지%20리뉴얼%204%20-%20Spring%20Security/" data-baseprotocol="https:" data-basehost="gusah009.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main class="flex flex-col h-full"><div><div class="hidden z-40 lg:flex lg:w-64 lg:flex-col lg:fixed lg:inset-y-0"><div class="absolute top-0 right-0 -mr-12 pt-2"><button type="button" class="-ml-[90px] flex items-center justify-center h-8 w-8 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white"><span class="sr-only">Close sidebar</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="h-6 w-6 text-black"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><div class="flex flex-col flex-grow bg-white shadow-lg shadow-slate-200 overflow-y-auto"><div class="w-full flex flex-col items-center px-4 mt-14 "><a href="/"><img class="w-20 h-20 mb-3 rounded-md" src="https://avatars.githubusercontent.com/u/26597702?v=4" alt="profile"/></a><div class=" text-slate-900 text-md font-bold mb-5">gusah009</div><div class="flex space-x-6"><a href="https://devblog-gusah009.notion.site/gusah009-1f41013097914875a99b6af4134bce9e" target="_blank"><svg class="fill-slate-900 hover:fill-slate-500 stroke-slate-900 stroke-0" xmlns="http://www.w3.org/2000/svg" focusable="false" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M4.459 4.208c.746.606 1.026.56 2.428.466l13.215-.793c.28 0 .047-.28-.046-.326L17.86 1.968c-.42-.326-.981-.7-2.055-.607L3.01 2.295c-.466.046-.56.28-.374.466zm.793 3.08v13.904c0 .747.373 1.027 1.214.98l14.523-.84c.841-.046.935-.56.935-1.167V6.354c0-.606-.233-.933-.748-.887l-15.177.887c-.56.047-.747.327-.747.933zm14.337.745c.093.42 0 .84-.42.888l-.7.14v10.264c-.608.327-1.168.514-1.635.514c-.748 0-.935-.234-1.495-.933l-4.577-7.186v6.952L12.21 19s0 .84-1.168.84l-3.222.186c-.093-.186 0-.653.327-.746l.84-.233V9.854L7.822 9.76c-.094-.42.14-1.026.793-1.073l3.456-.233l4.764 7.279v-6.44l-1.215-.139c-.093-.514.28-.887.747-.933zM1.936 1.035l13.31-.98c1.634-.14 2.055-.047 3.082.7l4.249 2.986c.7.513.934.653.934 1.213v16.378c0 1.026-.373 1.634-1.68 1.726l-15.458.934c-.98.047-1.448-.093-1.962-.747l-3.129-4.06c-.56-.747-.793-1.306-.793-1.96V2.667c0-.839.374-1.54 1.447-1.632z"></path></svg></a><a href="https://github.com/gusah009" target="_blank"><svg class="fill-slate-900 hover:fill-slate-500 stroke-slate-900" stroke-width="0" viewBox="0 0 496 512" height="32" width="32" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="mailto:gusah009@naver.com"><svg class="fill-slate-900 hover:fill-slate-500 stroke-slate-900" stroke-width="0" viewBox="0 0 24 24" height="32" width="32" xmlns="http://www.w3.org/2000/svg"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></svg></a></div></div><div class="w-full px-3 pt-8"><button class="flex mt-1 w-full justify-between ui-not-open:rounded-md ui-open:rounded-t-md px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200" id="headlessui-disclosure-button-:R9l9:" type="button" aria-expanded="false" data-headlessui-state=""><span>JAVA</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class=" h-5 w-5 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg></button><button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="ml-4 border-l-2"></div><button class="flex mt-1 w-full justify-between ui-not-open:rounded-md ui-open:rounded-t-md px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200" id="headlessui-disclosure-button-:Ral9:" type="button" aria-expanded="false" data-headlessui-state=""><span>PROJECTS</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class=" h-5 w-5 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg></button><button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="ml-4 border-l-2"></div><button class="flex mt-1 w-full justify-between ui-not-open:rounded-md ui-open:rounded-t-md px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200" id="headlessui-disclosure-button-:Rbl9:" type="button" aria-expanded="false" data-headlessui-state=""><span>CICD</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class=" h-5 w-5 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg></button><button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="ml-4 border-l-2"></div><button class="flex mt-1 w-full justify-between ui-not-open:rounded-md ui-open:rounded-t-md px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200" id="headlessui-disclosure-button-:Rcl9:" type="button" aria-expanded="false" data-headlessui-state=""><span>ETC</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class=" h-5 w-5 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg></button><button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="ml-4 border-l-2"></div><button class="flex mt-1 w-full justify-between ui-not-open:rounded-md ui-open:rounded-t-md px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200" id="headlessui-disclosure-button-:Rdl9:" type="button" aria-expanded="false" data-headlessui-state=""><span>일상</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class=" h-5 w-5 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg></button><button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="ml-4 border-l-2"></div></div></div></div><div class=" lg:pl-64 flex flex-col flex-1"><div class="sticky top-0 z-10 flex-shrink-0 flex h-12 bg-white shadow"><button type="button" class="px-4 border-r border-gray-200 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500 lg:hidden"><span class="sr-only">Open sidebar</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h7"></path></svg></button><button type="button" class="px-4 border-r border-gray-200 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500 hidden "><span class="sr-only">Open sidebar</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h7"></path></svg></button><div class="flex-1 flex"><a class="flex items-center" style="margin-left:0%" href="/keeper-homepage/2022-08-13-키퍼 홈페이지 리뉴얼 4 - Spring Security/"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained w-8 drop-shadow-md"><div style="max-width:109px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;99.99999999999999&#x27; width=&#x27;109&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAADyklEQVQ4y12UbUxbZRTHT7l8YXYtFO86p9PV6JClC02gA1O78lKcvPRFHBjDlBUTSOSLEU0wxJjosg/ug0uWKbBk2RhIF5ORkfoCuuk+bdGgodGETLcuEuvoDKyktfS+PH/z3Aul5dyce2+ePOd3zz3nPH8iIqqocBAA6u0dJputUiDdnjOby19ub38jEQiE4PeHVL//uBII9MLj8V8gImdZmWUn37hjh0mwWHZrHMoHOp2NBputki9V+3zHl/v6hnHnToatroIlEsDyMpBKgV269B06OvrhcrV8xuO4lZc/VlRRUaXD7HYn+XzHNuGeUGgwHo0moKrIqqrKAAUAf3KXkc1ClSRIo6NXeLajomgt5bEOh4tyaTqd9YIoPkEWy67Jc+dmAWBdVdchSTKTZQUsZ2CKIkNRMuzhQyg+X4inaOeMvXufETRgdfVhA5FAe/bs8w8MfHQ3Go2DMagAGLYZJ26ss2wWbHLymtLQEJwgorJc/Q4d8gjFxTvJat03Nj4+zQOyYCpSqTSGhj7AyZOnNJCqqhp0bu4aenr6sLCwoCaTQGvrMZ5lZQ5YW+spMhiMJIpPnQqHL/MYmWewsrqC/fur4HY3a0BF0YGnT58FUQmbmYlozTpy5LU1Ino2B6ypcQsGwyNktdo+nZr6UgNm4sDfC0nU1tTDH+gCU7cyHBs7D3HXk7hy4VsWjwGtbd1pInqa8o1naDLt/mRiIqwB7/6cwOL1fxCbTyCx/C8Yv/T6IZVO4favfyE+n2J//C7hpZZX/+NNNhr1MhYTkVlv+/PnZ2a+0oDvDr6Prs7XcXvxz1wzNj2/R7GYzDo730JV1Qv36uqaD1J9ve/DxsbgFBF9fObMCN+kyLLMYveWcOPGTbwzOIRkci2/w5sNYrzZS0tZ3L8PeXExhbq6JlB//zCmp39CW1sQs7PfawG8ViMjUzhx4iwymfUCWOH46Ldo9DdEIl/D5Wq6Sd3db0srK/pc6ftyc7Z99vJ/W7NUSsWtW79IHs+L10tKHv28oaGlmHp63kMmA1mWM1AU/SRwHs+S+3YYf9P+FjJbW4Pc3t7LZ/Ag78GBA9UCNTcfnQ6Hf+AxEmPZja8DuXNW6BsPWds/Pj4Hr/eVy6WlZpGLhN3uNGjq43R6r4bDP/KKrPPjlCcGyHNNHBiTNNjFi3NwOA6HN6aERPHxopx8EVFJU1PH1a6uAUQi80inwbhUPXhQ6HwtnYbMM8uHGY3mLT00mco1QRWEIpGIXF7v0W+4iHIx9fs1Yd10xteCwTfhdrd9sQUrLRDX/wGSgXZ6erYz6gAAAABJRU5ErkJggg==" alt=""/><picture><source type="image/webp" data-srcset="/static/e9127b8e576402d43e65260030c6fa43/6ad34/ghost.webp 27w,/static/e9127b8e576402d43e65260030c6fa43/b13ee/ghost.webp 55w,/static/e9127b8e576402d43e65260030c6fa43/e1ec8/ghost.webp 109w,/static/e9127b8e576402d43e65260030c6fa43/6cadb/ghost.webp 218w" sizes="(min-width: 109px) 109px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 109px) 109px, 100vw" decoding="async" loading="lazy" data-src="/static/e9127b8e576402d43e65260030c6fa43/0d876/ghost.png" data-srcset="/static/e9127b8e576402d43e65260030c6fa43/d824c/ghost.png 27w,/static/e9127b8e576402d43e65260030c6fa43/fa736/ghost.png 55w,/static/e9127b8e576402d43e65260030c6fa43/0d876/ghost.png 109w,/static/e9127b8e576402d43e65260030c6fa43/8971a/ghost.png 218w" alt="Progress Image"/></picture><noscript><picture><source type="image/webp" srcSet="/static/e9127b8e576402d43e65260030c6fa43/6ad34/ghost.webp 27w,/static/e9127b8e576402d43e65260030c6fa43/b13ee/ghost.webp 55w,/static/e9127b8e576402d43e65260030c6fa43/e1ec8/ghost.webp 109w,/static/e9127b8e576402d43e65260030c6fa43/6cadb/ghost.webp 218w" sizes="(min-width: 109px) 109px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 109px) 109px, 100vw" decoding="async" loading="lazy" src="/static/e9127b8e576402d43e65260030c6fa43/0d876/ghost.png" srcSet="/static/e9127b8e576402d43e65260030c6fa43/d824c/ghost.png 27w,/static/e9127b8e576402d43e65260030c6fa43/fa736/ghost.png 55w,/static/e9127b8e576402d43e65260030c6fa43/0d876/ghost.png 109w,/static/e9127b8e576402d43e65260030c6fa43/8971a/ghost.png 218w" alt="Progress Image"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></a></div><a class="h-full flex items-end" href="/"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained w-9 -ml-4 mr-2 drop-shadow-md"><div style="max-width:150px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;171&#x27; width=&#x27;150&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEdklEQVQ4y82US1BbVRjHT8CN7aIL3flc2XFGN7qo2k2nrbTjECDlkcmDgFAShLaUgOWVS3mFQBKEQiAEGyAJhLxDIIYkEGibhmchCYhjbbEu2y50dLQLcrmfcw5QdXRauvPO/Oc7c+fO7/7POd//QwghlJ4uRBcu1iCxpAKJRKWIz5egN15/95hYLB2iKOUftXWKh7V1ikcyqv33vLwLXa++8vb7XO558m1BYRmSFFeiU6fSEXnOnctDEkklys4uYGVm5qPc3JIPeDzxULdm+Mm4JwTzixsQjsSI5hfXweEKgLpD93MOt7A3N7fkHR5PjHg8MSsr63OUkZG7Czx7NpvAAQCVlcmWJrxzEJpb2rHZv6E1vYOMVmdktP1GRtM3xDjdATo0twxOVxCKi7/0G4xutPXgMevo0Q//AkorribhP3A4Iv51vXV7OrSwoxsY2Zn0zsGdtbvM4vIms7TyHYPXLncQvtab6QlvCOStXU9Onsw489GxTxGXW8jCR0eAVL0yuVxaj4TCLywzoSXQD44lgjPzEFvfYsKRGOMa98O4J4C3z8Q3fmQmvLPQ3TOwrRswApst6ExLEyI+X5z81KGMak8qK5MhgbB40B+IgMHooH3+W8xa7D7cno+DecwFFus4LC5vwlrsHrg900yfdjDRpx0GNpsvZ7P5iPcv4GUCHPYHI2AwORKeyRDj9c2Cyz1FYBarB7BT39QNcLr8BKjtJ0AFmy14NtBocibcniBYbR4YGXUQ4JjFDaYRO9gdk2B3ToG2fyih1R4QaDA6El7fDQjfXoPgTIQAMXxmdgHCkSg43QHo7dMf1OE8DBvtialAGKLxLYgsxAnQZp8gZxjfeACmURe0yFUJ3YAJUlN5BwP6/LdgNfoDcUQc2icgsrAO0fUtMJic0NTclhh4MWAYVqP3SEL2HeLUxNa3wDiCge0v6vD/CBT+JzBKWgbf8vOAHI4IIZxhqfRqckVFw9O2GTbsXsqdtbsEMndzhQivo/H7e5eCgUZITeW34aRwued3gSkpmSw8ZfDoEolKB3GWTaOu/SwTKI4b1srq97Cx+ROMmt2kba7rRyEtTdBy4kQanlSslJQsFvrk4zN4ch1GCL2cni40W20+6O7R02bLJARnFgBvfV8453M3V6FPa4Dqmgb6q85+OH2a041Q0pFDh147fPz4Zwi99eZ7R6pr5MGGxo6HMqr9V3lrNzQ1dzIt8mugaNNAq6KHCL+vkylAJlNAVVUTVFbWM1eqGqHsct1vUin1S0nJFQdC6CU8AxdlVDt0XdODumMAVGodo+7Q4Qoqdf+edKBUaYGi2ggQV6q+DShKweDa0KiEi5dqgMMRuVFNbSvt9kwnxiyTCYvVS1ts3h2LjVTaulf31zaHj3a4ArTR5KKVqh5apdbsqNQaWqnSbHd29YNEIn2EqqqbwOX2kT4jk+QZwt84nF4YHDJDbV0zyCj5P5SfX/oYCQSSZbG4PF5UVB4tKiqPPU9icXmsoOBSTCCQ/F1RgUDybU5OQfBPrUkpZaI09W4AAAAASUVORK5CYII=" alt=""/><picture><source type="image/webp" data-srcset="/static/26dc7b21275899ad3a53ee1240a0494e/8c86a/grave.webp 38w,/static/26dc7b21275899ad3a53ee1240a0494e/21236/grave.webp 75w,/static/26dc7b21275899ad3a53ee1240a0494e/2b3c0/grave.webp 150w,/static/26dc7b21275899ad3a53ee1240a0494e/0edb4/grave.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" data-src="/static/26dc7b21275899ad3a53ee1240a0494e/faeed/grave.png" data-srcset="/static/26dc7b21275899ad3a53ee1240a0494e/4a48e/grave.png 38w,/static/26dc7b21275899ad3a53ee1240a0494e/000a1/grave.png 75w,/static/26dc7b21275899ad3a53ee1240a0494e/faeed/grave.png 150w,/static/26dc7b21275899ad3a53ee1240a0494e/7abe6/grave.png 300w" alt="Progress Image"/></picture><noscript><picture><source type="image/webp" srcSet="/static/26dc7b21275899ad3a53ee1240a0494e/8c86a/grave.webp 38w,/static/26dc7b21275899ad3a53ee1240a0494e/21236/grave.webp 75w,/static/26dc7b21275899ad3a53ee1240a0494e/2b3c0/grave.webp 150w,/static/26dc7b21275899ad3a53ee1240a0494e/0edb4/grave.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" src="/static/26dc7b21275899ad3a53ee1240a0494e/faeed/grave.png" srcSet="/static/26dc7b21275899ad3a53ee1240a0494e/4a48e/grave.png 38w,/static/26dc7b21275899ad3a53ee1240a0494e/000a1/grave.png 75w,/static/26dc7b21275899ad3a53ee1240a0494e/faeed/grave.png 150w,/static/26dc7b21275899ad3a53ee1240a0494e/7abe6/grave.png 300w" alt="Progress Image"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></a></div><main><div class="w-full h-72 md:h-96"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained !absolute -z-10 w-full h-72 md:h-96 object-cover brightness-50 bg-white"><div style="max-width:700px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;501.99999999999994&#x27; width=&#x27;700&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAACaUlEQVQoz1WTW2+bQBCF+f8PVR+a/pQ8tqqsxpfYJHYuxbCwV9awu7MLLAZycWhBqtR+mnk8M5qjMwEYfQLLDABAPwzjOL5fLn3fD30/+LYDSzFOEUJxXCj1+vZqjGGcCSGGYQgE59uHh8Uu5Iy3zo2vbzaXhOD7MGQZBmOKssxQwgjRShl5KooiQYhzYYwJOOdxmj4+P5+kbAAu57NGKSVks72lnLmqAoBSqVIpZ21tLQBIKbXWVVUFlJDwcFiFO5Km51xe2rNJEBfi7v6OC+GUAq2TFIlcuKpqWl/Vdet9PRMQjG/W6++LBUrTlrB3ys3jL8rocr2kjIHSpzxfbza/jpEpVa00GMM518ZMmzHG+6enzV3IGWsNvOcnk+EkRcvVMkGoqmvnqrmmtrMyiiKeCwAIGGN3D4fVbic496di9Gd7TKIoWq1XURwbpYqi4ELkeW6MAWuLspxMK4pJnMTxzWb9Y/Hz+Rj5ohyZ7ISMk/g23MUInavKWaCcydOp67rxfwJCcLjf32xuKaMNF6MybakIJc9RRCn13g8zfd93XTcMg1IqxRnj/OXlZbp5dntLsqzN8Mfbq8aEYLxarzKMrbVN09T/4JwDADsTyDw/Jmi336ui8JRf6kZzIfP8fr8XUlZ/mQyrqmbGzzRNM4Xkdrv9tlgIxtpcXrreCMEo3YU7yrkrS1OWhBIppXNuUjZNOyu994ED4LZOlTl731p36XrFeJZly/UKpam1IGUexzGe41kpXc6zzEzwcDh8vvr66cvV9fX15eNjHMdz22qtpZRgjLXWAKiyVEpZAGemB1JKAcCfhP0GRpjySnEymiEAAAAASUVORK5CYII=" alt=""/><picture><source type="image/webp" data-srcset="/static/33cf44000cc00249062e2900f9449e18/f38f2/SpringSecurity.webp 175w,/static/33cf44000cc00249062e2900f9449e18/ef216/SpringSecurity.webp 350w,/static/33cf44000cc00249062e2900f9449e18/22312/SpringSecurity.webp 700w" sizes="(min-width: 700px) 700px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 700px) 700px, 100vw" decoding="async" loading="lazy" data-src="/static/33cf44000cc00249062e2900f9449e18/93d06/SpringSecurity.png" data-srcset="/static/33cf44000cc00249062e2900f9449e18/a3d6b/SpringSecurity.png 175w,/static/33cf44000cc00249062e2900f9449e18/8032a/SpringSecurity.png 350w,/static/33cf44000cc00249062e2900f9449e18/93d06/SpringSecurity.png 700w" alt="thumbnail"/></picture><noscript><picture><source type="image/webp" srcSet="/static/33cf44000cc00249062e2900f9449e18/f38f2/SpringSecurity.webp 175w,/static/33cf44000cc00249062e2900f9449e18/ef216/SpringSecurity.webp 350w,/static/33cf44000cc00249062e2900f9449e18/22312/SpringSecurity.webp 700w" sizes="(min-width: 700px) 700px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 700px) 700px, 100vw" decoding="async" loading="lazy" src="/static/33cf44000cc00249062e2900f9449e18/93d06/SpringSecurity.png" srcSet="/static/33cf44000cc00249062e2900f9449e18/a3d6b/SpringSecurity.png 175w,/static/33cf44000cc00249062e2900f9449e18/8032a/SpringSecurity.png 350w,/static/33cf44000cc00249062e2900f9449e18/93d06/SpringSecurity.png 700w" alt="thumbnail"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><div class="flex flex-col w-full md:w-[725px] lg:w-[840px] h-full my-0 mx-auto py-10 px-5 md:py-14 md:px-0 text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class=" grid place-items-center w-7 h-7 md:w-10 md:h-10 text-white cursor-pointer"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.707-10.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L9.414 11H13a1 1 0 100-2H9.414l1.293-1.293z" clip-rule="evenodd"></path></svg><div class=" overflow-hidden break-words mt-auto text-ellipsis whitespace-normal line-clamp-2 text-2xl md:text-5xl font-bold">키퍼 홈페이지 리뉴얼 4 - 개발 초기 환경 설정 (Spring Security)</div><div class="flex justify-between items-start md:items-center mt-4 text-base md:text-lg font-normal md:font-semibold"><div>keeper_homepage</div><div>2022.08.13.</div></div></div></div><style data-emotion="css q7fpjh">.css-q7fpjh{line-height:1.8;font-size:16px;font-weight:400;}.css-q7fpjh p{padding:3px 0;margin-top:0;margin-bottom:10px;}.css-q7fpjh p,.css-q7fpjh blockquote,.css-q7fpjh ul,.css-q7fpjh ol,.css-q7fpjh dl,.css-q7fpjh table,.css-q7fpjh pre,.css-q7fpjh details{margin-top:0;margin-bottom:8px;}.css-q7fpjh h1,.css-q7fpjh h2,.css-q7fpjh h3{font-weight:800;margin-bottom:5px;}.css-q7fpjh *+h1,.css-q7fpjh *+h2,.css-q7fpjh *+h3{margin-top:25px;}.css-q7fpjh hr+h1,.css-q7fpjh hr+h2,.css-q7fpjh hr+h3,.css-q7fpjh h2+h3{margin-top:0;}.css-q7fpjh h1{font-size:30px;border-bottom:1px solid #d9dee3;}.css-q7fpjh h2{font-size:25px;border-bottom:1px solid #d9dee3;}.css-q7fpjh h3{font-size:20px;}.css-q7fpjh blockquote{margin:15px 0;padding:2px 14px;border-left:4px solid #bdbdbd;font-style:italic;color:#6e6e6e;}.css-q7fpjh blockquote>:last-child{margin-bottom:0;}.css-q7fpjh ol{margin-left:24px;padding:8px 0;list-style-type:decimal;}.css-q7fpjh ul{margin-left:20px;padding:8px 0;list-style-type:disc;}.css-q7fpjh table{display:block;width:100%;overflow:auto;padding:8px 0;}.css-q7fpjh table th{font-weight:600;background-color:#778899;}.css-q7fpjh table td,.css-q7fpjh table th{padding:6px 13px;border:1px solid #dfe2e5;}.css-q7fpjh table tr{background-color:#fff;border-top:1px solid #c6cbd1;}.css-q7fpjh table tr:nth-child(2n){background-color:#f6f8fa;}.css-q7fpjh hr{border:1px solid #000000;margin:100px 0;}.css-q7fpjh a{color:#4263eb;-webkit-text-decoration:underline;text-decoration:underline;}.css-q7fpjh .language-text{padding:2px 4px;margin:0px 2px;background:#e9e9e9;color:#f00;font-size:14px;border-radius:0.25rem;}</style><div class="flex flex-col w-auto md:w-[725px] lg:w-[840px] mx-3 sm:mx-auto my-0 py-14 px-5 md:py-16 md:px-0 break-all css-q7fpjh e1ijh0y10"><blockquote>
<p>오늘 동아리 회장 선거를 진행했는데, 동아리원들이 직접 만든 선거 페이지로 선거를 진행했습니다. 실시간 투표율부터, 투표 결과를 다이나믹한 애니메이션으로 보여줘서 너무 감격이었습니다. 감동 받은 김에 홈페이지 관련 글을 하나 더 써보려고 합니다!</p>
</blockquote>
<h2>아직 개발 시작 전…</h2>
<p>앞선 블로그에서 말했듯이 <strong>인증/인가</strong>파트 역시 개발 전에 진행해야 하는 부분이었습니다. 본격적인 개발 전에 반드시 진행해야 한다고 생각한 이유는 아래와 같습니다.</p>
<ol>
<li>인증/인가 파트는 모든 기능에 영향을 미치는 <strong>횡단 관심사</strong>입니다. 그렇기 때문에 해당 기능 없이 개발을 하다가 후에 많은 부분을 변경해야 할 지도 모르는 상황이었습니다.</li>
<li>우연히 본 <a href="https://www.youtube.com/watch?v=aEk-7RjBKwQ" target="_blank" rel="nofollow">어떤 영상</a>에서 Spring Security가 어려운 기술이라고 했습니다. <strong>시간이 얼마나 걸릴 지 모르는 블랙박스</strong> 파트였기 때문에 무엇보다 먼저, 우선순위를 두고 개발에 착수해야 했습니다.</li>
</ol>
<p>위와 같은 이유들 때문에 PM인 제가 먼저 <strong>인증/인가</strong> 파트를 개발해놓기로 결심했습니다.</p>
<h2>이게 뭐람</h2>
<p>Spring Security를 알기 위해 굉장히 많은 사전 지식이 필요했습니다. 하지만 공부했던 자세한 내용을 적는건 리뷰글에 어울리지 않기 때문에 최대한 쉽게 풀어서 쓰도록 하겠습니다!</p>
<h3>쿠키, 세션, JWT</h3>
<p>일단 인증/인가 방식을 결정해야 했습니다. 후보군은 총 쿠키, 세션, JWT로 3개가 있었습니다. 그 중에 저희는 JWT를 선택했는데, 그 이유는 아래와 같습니다.</p>
<ol>
<li><strong>쿠키</strong>: 클라이언트 단에서 아무 암호화 없이 저장되서 너무 위험함.</li>
<li><strong>세션</strong>: 웹 도메인의 핵심인 HTTP가 stateless한데, 세션은 뭔가 stateful한 느낌이 강함.</li>
<li><strong>JWT</strong>: 클라이언트 단에서 저장되지만 암호화 되어 있고, stateless함.</li>
</ol>
<h3>필터, 인터셉터, AOP</h3>
<p>다음으로 이해해야 하는 부분은 <strong>필터</strong>였습니다. Spring Security는 필터단에서 구성됩니다. 횡단 관심사를 쉽게 개발해주기 위해 스프링 생태계에선 크게 필터, 인터셉터, AOP로 나뉘어지는데 각각의 차이는 어느 위치에서 횡단 관심사를 구현하는 지에 있습니다. 해당 내용을 이해하는데 <a href="https://goddaehee.tistory.com/154" target="_blank" rel="nofollow">이 글</a>의 도움을 많이 받았습니다.</p>
<p>필터는 쉽게 말하면 <strong>스프링에서 본격적으로 요청을 처리하기 전에</strong> 거쳐가는 길이라고 생각하시면 됩니다. 아래 그림에서 <strong>파란 화살표</strong>로 왔다갔다 하는 길이 Spring Security의 필터층입니다.</p>
<p><img src="https://user-images.githubusercontent.com/26597702/184363097-4b77d9fc-b56a-455b-985d-ddd515d8334d.png" alt="image"></p>
<p>필터층을 잘 보시면 <code class="language-text">JwtFilter</code>라던가 <code class="language-text">BearerFilter</code> 같은 JWT 전용 필터가 없습니다. Spring Security에서 공식적으로 지원해주지 않는 필터층이기 때문에 직접 구현해서 넣어야 했습니다.</p>
<h3>@Secured</h3>
<p><code class="language-text">@Secured</code>나 <code class="language-text">@PreAuthorize</code>를 사용하면 중앙에서 인증을 관리하는 것이 아니라, 각 컨트롤러에서 인증/인가 허용 범위를 조절할 수 있었습니다. 모든 url의 인증/인가를 중앙에서 관리하는 것보단 각각의 컨트롤러에서 관리하는 것이 훨씬 깔끔하고 가독성도 높다고 생각했기 때문에 <code class="language-text">@Secured</code>를 사용하기로 결정했습니다.</p>
<pre class="grvsc-container default-dark" data-language="java" data-index="0"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">http</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    .</span><span class="mtk11">authorizeRequests</span><span class="mtk1">() </span><span class="mtk3">// 다음 리퀘스트에 대한 사용권한 체크</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    .</span><span class="mtk11">antMatchers</span><span class="mtk1">(</span><span class="mtk8">&quot;/*/signin&quot;</span><span class="mtk1">, </span><span class="mtk8">&quot;/*/signup&quot;</span><span class="mtk1">).</span><span class="mtk11">permitAll</span><span class="mtk1">() </span><span class="mtk3">// 가입 및 인증 주소는 누구나 접근가능</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    .</span><span class="mtk11">antMatchers</span><span class="mtk1">(</span><span class="mtk12">HttpMethod</span><span class="mtk1">.</span><span class="mtk12">GET</span><span class="mtk1">, </span><span class="mtk8">&quot;helloworld/**&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    .</span><span class="mtk11">permitAll</span><span class="mtk1">() </span><span class="mtk3">// hellowworld로 시작하는 GET요청 리소스는 누구나 접근가능</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    .</span><span class="mtk11">anyRequest</span><span class="mtk1">().</span><span class="mtk11">hasRole</span><span class="mtk1">(</span><span class="mtk8">&quot;USER&quot;</span><span class="mtk1">) </span><span class="mtk3">// 그외 나머지 요청은 모두 인증된 회원만 접근 가능</span></span></span></code></pre>
<p>위 코드는 중앙 config에서 모든 인증/인가를 관리하는 것입니다. 하지만 <code class="language-text">@Secured</code>를 사용하면 아래와 같이 각 컨트롤러에서 관리할 수 있습니다. 각 컨트롤러에서 관리할 수 있다면 중앙 제어 코드는 필요 없다고 생각했기 때문에 <strong>위의 중앙에서 관리하는 코드를 모두 제거했습니다.</strong> (하지만 이게 예상치 못한 버그를 낳는 일로 이어집니다.)</p>
<pre class="grvsc-container default-dark" data-language="java" data-index="1"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">RequiredArgsConstructor</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">RestController</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">RequestMapping</span><span class="mtk1">(value = </span><span class="mtk8">&quot;/members&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">@</span><span class="mtk10">Secured</span><span class="mtk1">(</span><span class="mtk8">&quot;ROLE_USER&quot;</span><span class="mtk1">) </span><span class="mtk3">// ROLE_USER 권한만 접근 가능!</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">MemberController</span><span class="mtk1"> { ... }</span></span></span></code></pre>
<h2>이후에 개선한 점</h2>
<p>JWT 필터를 어떻게 구현하고, 어떻게 삽입할 지에 대해 고민을 많이 했고, 결국 구글링을 통해 코드를 집어넣었습니다. 그 과정에서 생긴 약간의 문제점들과 개선한 내용에 대해 작성하겠습니다.</p>
<h3>1. DB 접근</h3>
<p>세션과 JWT의 가장 큰 차이 중 하나가 DB에 부하가 걸리느냐 아니냐입니다. 세션은 매번 DB를 뒤져서 해당 요청의 사용자가 올바른 세션코드를 가지고 있는 지 확인해야 하지만, JWT는 토큰 내부적으로 인증/인가에 필요한 모든 정보를 담고 있기 떄문에 그럴 필요가 없어야 합니다.</p>
<p>하지만 구글링해서 가져온 코드에서는 아래와 같이 매번 DB에 접근하여 회원 정보를 가져오고, 그 정보로 인증/인가를 시도하고 있었습니다.</p>
<pre class="grvsc-container default-dark" data-language="java" data-index="2"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">UserDetails</span><span class="mtk1"> </span><span class="mtk11">loadUserByUsername</span><span class="mtk1">(</span><span class="mtk10">String</span><span class="mtk1"> userPk) {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk12">memberRepository</span><span class="mtk1">.</span><span class="mtk11">findById</span><span class="mtk1">(</span><span class="mtk12">Long</span><span class="mtk1">.</span><span class="mtk11">valueOf</span><span class="mtk1">(userPk))</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      .</span><span class="mtk11">orElseThrow</span><span class="mtk1">(CustomMemberNotFoundException</span><span class="mtk15">::new</span><span class="mtk1">);</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<p>이렇게 불필요한 DB 접근은 필요없다고 판단했고, 직접 JWT에서 권한 파트를 파싱해서 해당 내용으로 인증/인가를 진행하도록 변경하였습니다.</p>
<h3>2. Member Entity의 지저분해짐</h3>
<p><code class="language-text">Spring Security</code>는 내부적으로 <code class="language-text">Security Context</code>라는 인증/인가 context를 사용합니다. 이 <code class="language-text">Security Context</code>에 해당 회원의 인증/인가 정보를 담는데, 이 때 아이디는 일치하는지, 비밀번호는 일치하는지와 같은 메서드를 가지는 <code class="language-text">UserDetails</code> 인터페이스를 구현해야 했습니다. 처음엔 이를 아래와 같이 모두 <code class="language-text">MemberEntity</code>에 구현했습니다. 하지만 <code class="language-text">MemberEntity</code>가 하는 역할이 많아지고 FK를 많이 가질 수록 커지고 복잡해졌습니다.</p>
<pre class="grvsc-container default-dark" data-language="java" data-index="3"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">MemberEntity</span><span class="mtk1"> </span><span class="mtk4">implements</span><span class="mtk1"> </span><span class="mtk10">UserDetails</span></span></span></code></pre>
<p>그래서 JWT 인증/인가 전용 <code class="language-text">JwtEntity</code>를 따로 만들어서 구현하였습니다.</p>
<pre class="grvsc-container default-dark" data-language="java" data-index="4"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk4">class</span><span class="mtk1"> </span><span class="mtk10">JwtMemberEntity</span><span class="mtk1"> </span><span class="mtk4">implements</span><span class="mtk1"> </span><span class="mtk10">UserDetails</span><span class="mtk1"> {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">Collection</span><span class="mtk1">&lt;</span><span class="mtk4">?</span><span class="mtk1"> </span><span class="mtk4">extends</span><span class="mtk1"> </span><span class="mtk10">GrantedAuthority</span><span class="mtk1">&gt; </span><span class="mtk11">getAuthorities</span><span class="mtk1">() {</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    ...</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk11">getPassword</span><span class="mtk1">() { </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk8">&quot;&quot;</span><span class="mtk1">; }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">String</span><span class="mtk1"> </span><span class="mtk11">getUsername</span><span class="mtk1">() { </span><span class="mtk15">return</span><span class="mtk1"> id; }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">boolean</span><span class="mtk1"> </span><span class="mtk11">isAccountNonExpired</span><span class="mtk1">() { </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk4">true</span><span class="mtk1">; }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">boolean</span><span class="mtk1"> </span><span class="mtk11">isAccountNonLocked</span><span class="mtk1">() { </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk4">true</span><span class="mtk1">; }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">boolean</span><span class="mtk1"> </span><span class="mtk11">isCredentialsNonExpired</span><span class="mtk1">() { </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk4">true</span><span class="mtk1">; }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  @</span><span class="mtk10">Override</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">public</span><span class="mtk1"> </span><span class="mtk10">boolean</span><span class="mtk1"> </span><span class="mtk11">isEnabled</span><span class="mtk1">() { </span><span class="mtk15">return</span><span class="mtk1"> </span><span class="mtk4">true</span><span class="mtk1">; }</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">}</span></span></span></code></pre>
<h3>3. 모든 비인증/비인가 요청이 403 Forbidden으로 옴</h3>
<img width="492" alt="image" src="https://user-images.githubusercontent.com/26597702/184517233-ad0c6ad8-75a1-48b4-a863-16a5406aae4d.png">
<p>인증/인가에는 두 가지 방식의 요청 거부가 있습니다. 인증이 되지 않은 사용자에게 던지는 401 요청 거부, 인가가 되지 않은 사용자에게 던지는 403 요청 거부입니다. 그런데, 어떤 요청이 와도 저희 프로젝트에선 403 Access Denied를 일으켰습니다. 그 원인에 대해 조사한 내용에 대해 말씀드리겠습니다.</p>
<p>앞서 <code class="language-text">@Secured</code>를 설명하는 내용에서 아래 코드를 모두 제거했었습니다.</p>
<pre class="grvsc-container default-dark" data-language="java" data-index="5"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">http</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    .</span><span class="mtk11">authorizeRequests</span><span class="mtk1">() </span><span class="mtk3">// 다음 리퀘스트에 대한 사용권한 체크</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    .</span><span class="mtk11">antMatchers</span><span class="mtk1">(</span><span class="mtk8">&quot;/*/signin&quot;</span><span class="mtk1">, </span><span class="mtk8">&quot;/*/signup&quot;</span><span class="mtk1">).</span><span class="mtk11">permitAll</span><span class="mtk1">() </span><span class="mtk3">// 가입 및 인증 주소는 누구나 접근가능</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    .</span><span class="mtk11">antMatchers</span><span class="mtk1">(</span><span class="mtk12">HttpMethod</span><span class="mtk1">.</span><span class="mtk12">GET</span><span class="mtk1">, </span><span class="mtk8">&quot;helloworld/**&quot;</span><span class="mtk1">)</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    .</span><span class="mtk11">permitAll</span><span class="mtk1">() </span><span class="mtk3">// hellowworld로 시작하는 GET요청 리소스는 누구나 접근가능</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    .</span><span class="mtk11">anyRequest</span><span class="mtk1">().</span><span class="mtk11">hasRole</span><span class="mtk1">(</span><span class="mtk8">&quot;USER&quot;</span><span class="mtk1">) </span><span class="mtk3">// 그외 나머지 요청은 모두 인증된 회원만 접근 가능</span></span></span></code></pre>
<p>제 계획은 <code class="language-text">@Secured</code>를 사용하지 않은 Controller는 모두 접근이 가능하고ㅠ, <code class="language-text">@Secured</code>를 사용한 Controller에 토큰이 없거나 잘못됐다면 401 Unauthorized 에러를 발생시키는 것이었습니다. 하지만 Spring Security에서 토큰이 없거나 잘못된 사용자를 막지 않았고, 그저 인증은 됐지만 권한이 없는 사용자라고 판단하여 403 Access Denied 에러만 낼 뿐이었습니다. 이유는 바로 아래 필터에 있었습니다.</p>
<img width="137" alt="image" src="https://user-images.githubusercontent.com/26597702/184517252-b1d3cb20-60c9-4b9f-9a6b-ea8889f02d84.png" style="margin:auto; display:block">
<p>눈여겨 봐야 할 부분은 <code class="language-text">Anonymous AuthenticationFilter</code> 였습니다. 토큰이 없거나 잘못되어서 인증이 되지 않았다고 생각했던 모든 사용자가 Anonymous라는 사용자로 둔갑해서 지금까지 동작해 왔던 것이었습니다. 401에러와 403에러를 구분하기 위해서 어떤 인증이라도 필요한 controller의 경우엔 위에서 삭제했던 코드를 다시 살려야 했습니다.</p>
<h2>아쉬운 점</h2>
<p>그럼에도 아직 부족한 부분이 많았습니다. 인지는 하고 있지만 꽤 시간이 걸릴 것 같아서 개발하지 않은 부분은 아래와 같습니다.</p>
<h3>1. 로그인을 <code class="language-text">UsernamePasswordAuthenticationFilter</code>를 사용하지 못한점</h3>
<p>앞선 필터에서 <code class="language-text">UsernamePasswordAuthenticationFilter</code>라는 필터가 있었습니다. username과 password를 이용해 인증/인가를 진행하는 부분인데, 저희의 로그인 방식도 username, password 방식을 따르기 때문에 필터단에서 처리할 수 있을 것 같습니다.</p>
<h3>2. OAuth2로 SNS 로그인 구현하지 못한 점</h3>
<p>OAuth2는 당시 최우선과제가 아니었습니다. 일단 인증/인가를 할 수 있도록 해놓는 것이 목표였기 때문에 미뤄졌지만, 꼭 개발해보고 싶은 부분 중 하나입니다.</p>
<h3>3. refresh token</h3>
<p>현재는 토큰이 만료되면 곧바로 로그인창을 띄워서 다시 로그인 하도록 되어있습니다. 하지만 JWT 특성상 만료시간을 짧게 두기 때문에, 사용자가 계속해서 로그인을 해야 하는 불편함이 있습니다. 이 부분도 꼭 개발하고 싶은 부분입니다.</p>
<h2>Spring Security</h2>
<p>글을 작성하다보니, 생각보다 깊이 들어가는 것 같습니다. 최대한 기술적인 내용을 제외하려 했는데, 기술적인 내용을 제외하려니 문제가 생긴 부분을 설명 할 수가 없어서 기술적인 부분이 자꾸 추가되었습니다. 리뷰글인 만큼 다음엔 최대한 쉽게 풀어쓰도록 노력 해보겠습니다!</p>
<p>다음 글은 저희 팀이 어떻게 개발 했는 지 <strong>개발 과정</strong>에 대해 작성해보겠습니다. 그럼 안녕~</p>
<style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line > * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: ' ';
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {
    content: ' ';
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .default-dark {
    background-color: #1E1E1E;
    color: #D4D4D4;
  }
  .default-dark .mtk1 { color: #D4D4D4; }
  .default-dark .mtk11 { color: #DCDCAA; }
  .default-dark .mtk3 { color: #6A9955; }
  .default-dark .mtk8 { color: #CE9178; }
  .default-dark .mtk12 { color: #9CDCFE; }
  .default-dark .mtk10 { color: #4EC9B0; }
  .default-dark .mtk4 { color: #569CD6; }
  .default-dark .mtk15 { color: #C586C0; }
  .default-dark .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));
  }
</style></div><div class="py-0 px-5 md:p-0  md:w-[725px] lg:w-[840px] mx-auto"></div><footer class=" grid place-items-center mt-auto p-12 text-xs md:text-sm text-center leading-6 text-gray-600">Thank You for Visiting My Blog, Have a Good Day 😆<br/>© 2022 정현모, Powered By Gatsby.</footer></main></div></div></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/keeper-homepage/2022-08-13-키퍼 홈페이지 리뉴얼 4 - Spring Security/";window.___webpackCompilationHash="74c6ff8d510f9f4383a1";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-c857dff8cba8f79dec61.js"],"app":["/app-685314128435bcfb57a1.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-1412a1274f0f9067667f.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-1c39fcaf757a409e2dc2.js"],"component---src-templates-post-template-tsx":["/component---src-templates-post-template-tsx-9a9068661456bbe1688f.js"]};/*]]>*/</script><script src="/polyfill-c857dff8cba8f79dec61.js" nomodule=""></script><script src="/app-685314128435bcfb57a1.js" async=""></script><script src="/framework-9a7e817db04652ee5936.js" async=""></script><script src="/webpack-runtime-74b49ef79632799364da.js" async=""></script></body></html>