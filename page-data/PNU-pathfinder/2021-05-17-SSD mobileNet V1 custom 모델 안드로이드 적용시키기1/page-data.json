{"componentChunkName":"component---src-templates-post-template-tsx","path":"/PNU-pathfinder/2021-05-17-SSD mobileNet V1 custom 모델 안드로이드 적용시키기1/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>이번에 소프트웨어설계실험 과목에서 진행한 <strong>부산대 길찾기</strong>프로젝트에서 객체인식 모델 학습부분입니다.</p>\n<h1>서론</h1>\n<p>tensorflow 객체인식이라는 처음접하는 분야에, android 역시 한번도 해본 적이 없던 저에겐 큰 도전이었습니다. 이번 건물인식 프로젝트를 진행하면서 했던 많은 삽질들을 여기 공유하고, 다른 사람들이 이로인해 시간을 허비하지 않길 바라면서 블로그 글을 작성합니다… ㅠㅠ</p>\n<p>tensorflow android object detection 에서 제공하는 기본 모델이 이유는 모르겠지만 SSD mobileNet v1을 지원하고 있습니다. v2로는 진행을 해보진 않았습니다.</p>\n<h1>개발환경</h1>\n<ul>\n<li>windows 10</li>\n<li>conda</li>\n<li>(base) python 3.8 tensorflow 2.4.1, tensorflow-gpu==2.4.1</li>\n<li>(ssdV1) python 3.7 tensorflow 1.15.0, tensorflow-gpu==1.15.0</li>\n<li>CUDA 10.0</li>\n<li>cuDNN==7.6.0 for CUDA 10.0</li>\n</ul>\n<h2>환경 세팅</h2>\n<p>먼저 환경을 맞추기 위해 pip를 초기화하였습니다.</p>\n<p>위에 tensorflow를 2.4.1과 1.15.0 두 개를 사용하는 이유는 뒤에 진행하면서 tensorflow 버전이 1이라서 안되는 경우가 있고, 2라서 안되는 경우가 있어서 다음과 같이 전체 tensorflow 버전은 2.4.1로 맞추고, ssdV1 가상환경은 1.15.0으로 맞춰서 진행하였습니다.</p>\n<p>학습시엔 tensorflow-gpu 1.14.0 버전으로 진행하기위해 CUDA와 cuDNN 버전은 1.15.0 버전에 맞췄습니다. -> <a href=\"https://www.tensorflow.org/install/source_windows#tested_build_configurations\" target=\"_blank\" rel=\"nofollow\">tensorflow-gpu 버전 확인하기</a></p>\n<h3>전역 pip 세팅</h3>\n<p>먼저, 필요한 pip를 설치해줍니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">pip3 install tensorflow==2.4.1 tensorflow-gpu==2.4.1 pillow Cython lxml jupyter matplotlib</span></span></code></pre>\n<h3>가상환경 pip 세팅</h3>\n<p>다음으로 conda 가상환경을 만들어 주겠습니다. (anaconda는 설치되어있다고 가정하고 진행하겠습니다) anaconda prompt에서 다음과 같이 실행시킵니다</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">conda create -n ssdV1 python=3.7</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">conda activate ssdV1</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">pip3 install tensorflow==1.15.0 tensorflow-gpu==1.15.0 pillow Cython lxml jupyter matplotlib pandas</span></span></code></pre>\n<blockquote>\n<p>저는 관리자 권한 anaconda prompt에서 실행시켰습니다.</p>\n</blockquote>\n<h3>tensorflow model 가져오기</h3>\n<p>각자 개발할 환경에 들어가셔서 아래 명령어를 실행시켜주시면 됩니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">cd (각자 개발환경 dir 내부)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">git clone https://github.com/tensorflow/models.git</span></span></code></pre>\n<p>protobuf를 컴파일하고, PYTHONPATH를 변경해줍니다. <a href=\"https://github.com/protocolbuffers/protobuf/releases\" target=\"_blank\" rel=\"nofollow\">protobuf windows 다운 사이트</a></p>\n<blockquote>\n<p>저는 protoc-3.17.0-win64.zip을 다운받았습니다.</p>\n</blockquote>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">cd &lt;개발환경&gt;\\models\\research\\</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">&lt;protoc 폴더&gt;\\bin\\protoc.exe object_detection/protos/*.proto --python_out=.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">set PYTHONPATH=%PYTHONPATH%&lt;개발환경&gt;\\models;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">set PYTHONPATH=%PYTHONPATH%&lt;개발환경&gt;\\models\\research;</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">set PYTHONPATH=%PYTHONPATH%&lt;개발환경&gt;\\models\\research\\slim;</span></span></code></pre>\n<h3>개발환경 테스트</h3>\n<p>그리고 다음 명령어로 테스트 했을 때 됐다는 메시지가 뜨고 아무반응이 없으면 성공입니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">python object_detection/builders/model_builder_test.py</span></span></code></pre>\n<blockquote>\n<p>에러가 나는 경우</p>\n</blockquote>\n<ol>\n<li><code class=\"language-text\">ModuleNotFoundError: No module named 'tf_slim'</code></li>\n</ol>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">pip install tf_slim</span></span></code></pre>\n<ol start=\"2\">\n<li><code class=\"language-text\">ModuleNotFoundError: No module named 'scipy'</code></li>\n</ol>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">pip install scipy</span></span></code></pre>\n<h1>폴더 구조화 &#x26; 이미지 데이터 정리</h1>\n<p>이 글의 대부분의 작업은 models 폴더 안에서 실행됩니다.</p>\n<h2>폴더 구조화</h2>\n<p>우선 폴더구조를 아래와 같이 생성합니다.</p>\n<blockquote>\n<p>models <br>\n\\— annotations <br>\n\\— images <br>\n\\------ train <br>\n\\------ test <br>\n\\— checkpoints <br>\n\\— tf_record <br>\n\\— research <br>\n\\— data <br>\n\\— …</p>\n</blockquote>\n<p>images 아래에 train과 test를 적절한 비율 (7:3)으로 나누어 저장합니다. (이 때, 이미지 파일들은 1부터 순서대로 존재해야합니다!)</p>\n<h2>이미지 라벨링</h2>\n<p>이미지 라벨링은 <a href=\"https://github.com/tzutalin/labelImg\" target=\"_blank\" rel=\"nofollow\">https://github.com/tzutalin/labelImg</a>의 labelImg를 사용하시는 것을 추천드립니다.\n설치가 귀찮으신 분은 <a href=\"https://tzutalin.github.io/labelImg/\" target=\"_blank\" rel=\"nofollow\">https://tzutalin.github.io/labelImg/</a> 이 페이지에서 최신 버전을 다운받아서 사용하시면 됩니다.</p>\n<p>이미지 라벨링이 끝나신 분들은 jpg파일과 xml파일들이 train, test 폴더내에 존재하면 됩니다.</p>\n<blockquote>\n<p>저만 그랬을 수도 있지만, xml 파일 안에 이미지 파일의 위치가 저장됩니다.</p>\n</blockquote>\n<p>xml 파일들을 다시한번 열어서 모두 고치고싶지 않으시다면 이미지 파일들을 미리 train, test 폴더안에 넣어놓고 라벨링 하시는 것을 추천드립니다!</p>\n<h3>label_map.txt</h3>\n<p>다음으로 label_map.txt 파일을 models\\annotations 안에 생성합니다. 아래와 같은 예시로 생성하시면 됩니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"json\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">item {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk14\">id</span><span class=\"mtk1\">: </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk14\">name:</span><span class=\"mtk1\"> </span><span class=\"mtk14\">&#39;person&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">item {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk14\">id</span><span class=\"mtk1\">: </span><span class=\"mtk7\">2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk14\">name:</span><span class=\"mtk1\"> </span><span class=\"mtk14\">&#39;dog&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<h3>xml to csv</h3>\n<p>이제 XML 파일을 CSV 파일로 전환해야 합니다. 아래의 코드를 models\\xml_to_csv.py 파일로 저장하고 실행시키면 됩니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">python xml_to_csv.py</span></span></code></pre>\n<p>그럼 이제 models\\data 폴더안에 test_labels.csv 파일과 train_labels.csv 파일이 생깁니다.\n<a href=\"gist.github.com/iKhushPatel/ed1f837656b155d9b94d45b42e00f5e4\">gist.github.com/iKhushPatel/ed1f837656b155d9b94d45b42e00f5e4</a></p>\n<h3>tfrecord 파일 수정</h3>\n<p>아래의 코드를 models\\research\\object_detection\\dataset_tools\\generate_tfrecord.py 파일로 저장하시고 몇몇 부분을 수정해주셔야 합니다.\n<a href=\"github.com/datitran/raccoon_dataset/blob/master/generate_tfrecord.py#L25\">github.com/datitran/raccoon_dataset/blob/master/generate_tfrecord.py#L25</a></p>\n<pre class=\"grvsc-container default-dark\" data-language=\"python\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">class_text_to_int</span><span class=\"mtk1\">(</span><span class=\"mtk12\">row_label</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> row_label == </span><span class=\"mtk8\">&#39;raccoon&#39;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">else</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">None</span></span></span></code></pre>\n<p>이 부분을 각자 label_map.txt 파일에 넣은 값대로 추가해주시면 됩니다.\nex)</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"python\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">def</span><span class=\"mtk1\"> </span><span class=\"mtk11\">class_text_to_int</span><span class=\"mtk1\">(</span><span class=\"mtk12\">row_label</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">if</span><span class=\"mtk1\"> row_label == </span><span class=\"mtk8\">&#39;person&#39;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">elif</span><span class=\"mtk1\"> row_label == </span><span class=\"mtk8\">&#39;dog&#39;</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk15\">return</span><span class=\"mtk1\"> </span><span class=\"mtk7\">2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15\">else</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">None</span></span></span></code></pre>\n<p>그리고 models 폴더로 나오셔서 아래 명령어를 실행시켜 줍니다. (train, test 두 번 돌리셔야 합니다)</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">python research/object_detection/dataset_tools/generate_tfrecord.py --csv_input=data/train_labels.csv --output_path=train.record --image_dir=images/train</span></span></code></pre>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">python research/object_detection/dataset_tools/generate_tfrecord.py --csv_input=data/test_labels.csv --output_path=test.record --image_dir=images/test</span></span></code></pre>\n<blockquote>\n<p>ModuleNotFoundError: No module named ‘object_detection’ 에러가 나는 경우</p>\n</blockquote>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">pip install tensorflow-object-detection-api</span></span></code></pre>\n<p>진행하시고 나면 models 폴더에 train.record, test.record 파일이 생성됩니다.</p>\n<h3>사전학습 모델 가져오기</h3>\n<p>아래에서 pre-trained model을 다운로드 받습니다.</p>\n<p><a href=\"download.tensorflow.org/models/object_detection/ssd_mobilenet_v1_coco_2018_01_28.tar.gz\">download.tensorflow.org/models/object_detection/ssd_mobilenet_v1_coco_2018_01_28.tar.gz</a></p>\n<p>위 파일의 압축을 풀고, model.ckpt.meta, model.ckpt.index, model.ckpt.data-00000-of-00001 3개의 파일을 models\\checkpoints 에 저장합니다.</p>\n<p>본격적인 학습은 다음글에서 계속하겠습니다.</p>\n<h3>config 파일 수정하기</h3>\n<p>models/research/object_detection/samples/configs 아래에 있는 ssd_mobilenet_v1_ coco 파일을 models/ 로 복사합니다.</p>\n<p>다음으로 3가지를 수정해주시면 됩니다.</p>\n<p><strong>1. num_classes 변경</strong></p>\n<pre class=\"grvsc-container default-dark\" data-language=\"python\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">ssd {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    num_classes: </span><span class=\"mtk7\">3</span><span class=\"mtk1\"> </span><span class=\"mtk3\"># 자기 클래스 개수로 변경</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    box_coder {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        faster_rcnn_box_coder {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            y_scale: </span><span class=\"mtk7\">10.0</span><span class=\"mtk1\"> </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            x_scale: </span><span class=\"mtk7\">10.0</span><span class=\"mtk1\"> </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            height_scale: </span><span class=\"mtk7\">5.0</span><span class=\"mtk1\"> </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            width_scale: </span><span class=\"mtk7\">5.0</span><span class=\"mtk1\"> </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\"> }</span></span></span></code></pre>\n<p><strong>2. fine_tune_checkpoint 변경</strong></p>\n<pre class=\"grvsc-container default-dark\" data-language=\"python\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">fine_tune_checkpoint: </span><span class=\"mtk8\">&quot;checkpoints/model.ckpt&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk3\"># model.ckpt 경로 입력</span></span></span></code></pre>\n<p><strong>3. train, eval input reader 변경</strong></p>\n<pre class=\"grvsc-container default-dark\" data-language=\"python\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">train_input_reader: { </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tf_record_input_reader { </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        input_path: </span><span class=\"mtk8\">&quot;train.record&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk3\"># train.record 경로 입력</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    label_map_path: </span><span class=\"mtk8\">&quot;annotations/label_map.txt&quot;</span><span class=\"mtk1\">  </span><span class=\"mtk3\">#  label_map.pbtxt 경로 입력</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">eval_input_reader: { </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    tf_record_input_reader { </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        input_path: </span><span class=\"mtk8\">&quot;test.record&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk3\"># test.record 경로 입력</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    } </span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    label_map_path: </span><span class=\"mtk8\">&quot;annotations/label_map.txt&quot;</span><span class=\"mtk1\">  </span><span class=\"mtk3\"># label_map.pbtxt 경로 입력</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    shuffle : false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    num_readers : </span><span class=\"mtk7\">1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }</span></span></span></code></pre>\n<h1>학습시키기</h1>\n<p>이제 학습 준비가 끝났습니다. 본격적인 학습을 진행해보겠습니다.\nmodels 폴더에서 아래 명령어를 실행시켜줍니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">mkdir train</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">mkdir eval</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">python research\\object_detection\\model_main.py --pipeline_config_path=ssd_mobilenet_v1_coco.config --model_dir=train --num_train_steps=200000 --sample_1_of_n_eval_examples=1 --alsologtostderr</span></span></code></pre>\n<blockquote>\n<p>NotImplementedError: Cannot convert a symbolic Tensor (cond_2/strided_slice:0) to a numpy array. 에러가 발생할 경우</p>\n</blockquote>\n<p>저는 numpy가 1.20.3이 설치되어 있었는데 , 1.18.4 버전으로 다운그레이드한 후에 정상적으로 동작했습니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">pip uninstall numpy</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">pip install numpy==1.18.4</span></span></code></pre>\n<blockquote>\n<p>ModuleNotFoundError: No module named ‘pycocotools’ 에러가 발생할 경우</p>\n</blockquote>\n<p>아래 블로그 글대로 따라 진행하시면 됩니다.\n<a href=\"https://blog.naver.com/PostView.nhn?blogId=tip9004&#x26;logNo=221270291955\" target=\"_blank\" rel=\"nofollow\">https://blog.naver.com/PostView.nhn?blogId=tip9004&#x26;logNo=221270291955</a></p>\n<blockquote>\n<p>ModuleNotFoundError: No module named ‘lvis’ 에러가 발생할 경우</p>\n</blockquote>\n<pre class=\"grvsc-container default-dark\" data-language=\"shell\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">pip install lvis</span></span></code></pre>\n<blockquote>\n<p>self._traceback = tf_stack.extract_stack() 에러가 발생할 경우</p>\n</blockquote>\n<p>research\\object_detection\\model_main.py 파일안에 아래와같이 추가해줍니다.\n(gpu 문제인것 같습니다)</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"python\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">from</span><span class=\"mtk1\"> tensorflow.compat.v1 </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> ConfigProto</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15\">from</span><span class=\"mtk1\"> tensorflow.compat.v1 </span><span class=\"mtk15\">import</span><span class=\"mtk1\"> InteractiveSession</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">config = ConfigProto()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">config.gpu_options.allow_growth = </span><span class=\"mtk4\">True</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">session = InteractiveSession(</span><span class=\"mtk12\">config</span><span class=\"mtk1\">=config)</span></span></span></code></pre>\n<p>저는 numpy를 1.17.4 버전으로 다운그레이드했을 때 해결이 됐습니다.</p>\n<p><img src=\"https://images.velog.io/images/gusah009/post/c4a13c78-a9b7-4401-b77d-4386ac0f0042/image.png\" alt=\"\">\n이런 화면이 뜨면서 학습이 진행되시면 됩니다. 다음 글은 학습이 끝난 이후에 다시 작성하겠습니다.</p>\n<p>출처: <a href=\"https://seoftware.tistory.com/108\" target=\"_blank\" rel=\"nofollow\">https://seoftware.tistory.com/108</a>,</p>\n<p><a href=\"https://github.com/tensorflow/examples/tree/master/lite/examples/object_detection/android\" target=\"_blank\" rel=\"nofollow\">https://github.com/tensorflow/examples/tree/master/lite/examples/object_detection/android</a>,</p>\n<p><a href=\"https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf1_training_and_evaluation.md\" target=\"_blank\" rel=\"nofollow\">https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf1_training_and_evaluation.md</a></p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk14 { color: #F44747; }\n  .default-dark .mtk7 { color: #B5CEA8; }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk11 { color: #DCDCAA; }\n  .default-dark .mtk12 { color: #9CDCFE; }\n  .default-dark .mtk15 { color: #C586C0; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk3 { color: #6A9955; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"title":"SSD mobileNet V1 custom 모델 안드로이드 적용시키기 (1/2)","summary":"이번에 소프트웨어설계실험 과목에서 진행한 **부산대 길찾기**프로젝트에서 객체인식 모델 학습부분입니다.","date":"2021.05.17.","categories":["pathfinder"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABF0lEQVQoz5VSXUvDQBDM//9Dgi8qWouIlFoRxIci1fiRtiGmba67N7OySdqGSisOw3HHZXbnJpuUZRlCABD/CVVNqqoSESOJaEdBcm+feE9Qq1XMM5r56TC8RQcJYiNeIh2DhqP4JQbcvhkmz/iawAwx7vi3OEYFECrenmKathozJ7njvpgbsap7zjMMe+ifcHiFLMX0Hd9zgPDiEXVK2HLXWdUbumdFOuZDn6M+7844uMDg3Dm8xOMNR9d4GuC+h09/YEcMtFF3y4ugWmJRuKlixuwNHy/OYt7aFpEQgoioqoo41/WqolG1TkRBX0k1c4I+JE0G/p222n1sbzrVRcTfXCyWr/l6tvIa8cCQNuE2m81P9HH8AfEtvWYqDufzAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/566e2033ea33b3ea3c36622f93317786/70f15/pathfinder_loss.png","srcSet":"/static/566e2033ea33b3ea3c36622f93317786/5738e/pathfinder_loss.png 211w,\n/static/566e2033ea33b3ea3c36622f93317786/16394/pathfinder_loss.png 422w,\n/static/566e2033ea33b3ea3c36622f93317786/70f15/pathfinder_loss.png 843w","sizes":"(min-width: 843px) 843px, 100vw"},"sources":[{"srcSet":"/static/566e2033ea33b3ea3c36622f93317786/824e6/pathfinder_loss.webp 211w,\n/static/566e2033ea33b3ea3c36622f93317786/1a33f/pathfinder_loss.webp 422w,\n/static/566e2033ea33b3ea3c36622f93317786/b762a/pathfinder_loss.webp 843w","type":"image/webp","sizes":"(min-width: 843px) 843px, 100vw"}]},"width":843,"height":518}},"publicURL":"/static/566e2033ea33b3ea3c36622f93317786/pathfinder_loss.png"}}}}]}},"pageContext":{"slug":"/PNU-pathfinder/2021-05-17-SSD mobileNet V1 custom 모델 안드로이드 적용시키기1/"}},"staticQueryHashes":[]}