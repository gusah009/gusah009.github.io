{"componentChunkName":"component---src-templates-post-template-tsx","path":"/infra/2024-11-19-istio/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>출처: <a href=\"https://istio.io/latest/docs/\" target=\"_blank\" rel=\"nofollow\">https://istio.io/latest/docs/</a></p>\n<h1>Why Istio?</h1>\n<h2>Envoy 사용</h2>\n<p>왜 istio를 사용해야 할까요?</p>\n<p>첫번째 이유로는 Envoy를 사용한다는 점에 있습니다. Istio는 고성능 서비스 프록시인 Envoy를 주 프록시로 사용하는데, 실제로 Istio팀은 Envoy 오픈소스 최초의 외부 커미터였고 꾸준한 지원을 하고 있습니다.</p>\n<h2>eBPF 사용</h2>\n<p>pod에서 프록시로 트래픽을 보낼 떄 eBPF를 사용할 수 있지 않을까?</p>\n<ul>\n<li>실제로 istio에서 부분적으로 사용하는 곳도 있음. 그래서 iptables를 사용하는 것 보다 약간 성능이 향상됨.</li>\n<li>하지만 안되는 것들이 꽤 많음.</li>\n<li>eBPF는 L3 라우팅이 가능하지만 복잡한 네트워크 구성이나 L7 라우팅은 안됨.</li>\n</ul>\n<h2>CNI와의 차이점</h2>\n<blockquote>\n<p>이건 개인적으로 잘 와 닿진 않았습니다.</p>\n</blockquote>\n<p>CNI 플러그인이 일부 서비스 메시 기능을 제공할 수 있지만, <strong>비표준적이고 기능이 제한적이며 특정 CNI에 종속</strong>됩니다. 반면, <strong>Istio는 표준을 준수하고, 강력하고 일관된 기능 세트를 제공하며, 어떤 환경과 CNI에서도 동작</strong>합니다.</p>\n<p>따라서, <strong>보다 강력한 서비스 메시 기능, 보안, 유연성, 표준 준수를 위해 Istio를 사용하는 것이 좋습니다</strong>. Istio는 마이크로서비스 환경에서 서비스 간 통신을 효과적으로 관리하고, 애플리케이션의 복잡성을 줄이며, 운영 효율성을 높일 수 있습니다.</p>\n<h1>방식</h1>\n<p>크게 사이드카 방식과 ambient 방식으로 나뉩니다.</p>\n<ul>\n<li>ambient 방식은 사이드카 방식에 단점을 느껴 만든 방식입니다.</li>\n</ul>\n<h2>사이드카</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f25b6a13d63b981403fe5fb6a001be51/25327/image.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.8125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXklEQVQY0y2QXUvDMBSG+/tF8GIiCIoKClPB63khCNq5D12tm9qtSbpmbZPmJE23MbexkYidD+/d4Tm85ziU0vl8LoQAAFEhpVRKSSnzPAcAXai/KFlqVepiOp0aa40x1lqn1Wp1u13GGADkFZzzLMu01sYYrfX7N+p9ofdh1A/jL5LEk3S5/LEVzmKxKMsSAKIoSpKEUpqmqVKKTpLg86P+0DsfbC4+lqdvs/rQ7F1/7x/etltuLsRqtXJ2OwCAc+55nu/7QRBU8qTXebnr4CtsTzvyoBGce7OTR3F0ee/1uoxzpZSza88Y2x3p+z5CaLvdDkdh33u9eR4e923NFTUXai6chfai0c7TSbvdaTab//J6vZZSFkWhtS7Lsij+HmOtHWfi8TN7CnI3lC9Eu6EcjKJZNTLGOISQ8XiMEMIYowqMMSEkjuMoihjL0phQEsZ4REmYxoSzbLPZ7ORfdt5yZpH/iWgAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/f25b6a13d63b981403fe5fb6a001be51/a59e9/image.webp 192w,\n/static/f25b6a13d63b981403fe5fb6a001be51/0ca9f/image.webp 384w,\n/static/f25b6a13d63b981403fe5fb6a001be51/dc9b9/image.webp 768w,\n/static/f25b6a13d63b981403fe5fb6a001be51/ef8da/image.webp 837w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/f25b6a13d63b981403fe5fb6a001be51/3b721/image.png 192w,\n/static/f25b6a13d63b981403fe5fb6a001be51/66595/image.png 384w,\n/static/f25b6a13d63b981403fe5fb6a001be51/fe486/image.png 768w,\n/static/f25b6a13d63b981403fe5fb6a001be51/25327/image.png 837w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/f25b6a13d63b981403fe5fb6a001be51/fe486/image.png\"\n            alt=\"image.png\"\n            title=\"image.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>사이드카 방식은 모든 pod에 Envoy 프록시를 사이드카로 띄워서 pod로 향하는, pod에서 나오는 모든 트래픽을 envoy가 가로채 컨트롤 할 수 있게 하는 방식인데요, 2017년 첫 릴리즈부터 이 패턴으로 구축이 되었습니다.</p>\n<p>하지만 모든 파드에 Envoy가 붙기 때문에 리소스 비용과 운영 오버헤드가 발생하는 단점이 있습니다.</p>\n<h2>ambient 방식</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b3ba411f793782c73207d86b09e09e38/a8177/image1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.4375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABlElEQVQoz3XSz4vUMBQH8P7xIuLZg3jzuLsnveyuB0VGkMqI467OtnaSNE3TtM00v6vYNI1QRXDUz/37HnzfS4qiYIw1PzHW991w7I2WSgpjTIxxWZb4H0me54QQSiljTCv17buvuClbKe1XJYW1lrWtEOJkxLJKpmninEMIu64vsv3zze7hNbh/Cc7fZPubD7RhRVFgjEMI8xzmVQjh12atNee8LEuMMamqTtrr7eH1vkGd0krGGMM8AwBYQ0sEEUJZlkEIlVLOucQ5Z4yRK2OMn6aWVhU6OKOllD7Eiy19/OLT2TtStiIuwa+mafLeJ8MwCCH6Fef8eBwghFmWNw1r23by/ulb+uAK3LtCZyk+LWy322GMpZTDMByPw7IEUtcAohCCtTbGKI179jLd3ADUmdPwOI593yOECKkbgtO76smGPHpVXr6H+edbqbS1pmP0d0l/hGOMzjkAQE0po/XHAz1P8cWWpl8YKWFFyF2WUdqEZQl/HTyhlGKMyxUhRCulpXBGW6PHcYwxeu/nef7nk/wA2lQo97rPMGMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b3ba411f793782c73207d86b09e09e38/a59e9/image1.webp 192w,\n/static/b3ba411f793782c73207d86b09e09e38/0ca9f/image1.webp 384w,\n/static/b3ba411f793782c73207d86b09e09e38/dc9b9/image1.webp 768w,\n/static/b3ba411f793782c73207d86b09e09e38/e2c2f/image1.webp 1152w,\n/static/b3ba411f793782c73207d86b09e09e38/f3efb/image1.webp 1536w,\n/static/b3ba411f793782c73207d86b09e09e38/598c0/image1.webp 1710w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b3ba411f793782c73207d86b09e09e38/3b721/image1.png 192w,\n/static/b3ba411f793782c73207d86b09e09e38/66595/image1.png 384w,\n/static/b3ba411f793782c73207d86b09e09e38/fe486/image1.png 768w,\n/static/b3ba411f793782c73207d86b09e09e38/d2d74/image1.png 1152w,\n/static/b3ba411f793782c73207d86b09e09e38/e8464/image1.png 1536w,\n/static/b3ba411f793782c73207d86b09e09e38/a8177/image1.png 1710w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b3ba411f793782c73207d86b09e09e38/fe486/image1.png\"\n            alt=\"image.png\"\n            title=\"image.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>2022년에 출시된 ambient 방식은 사이드카 방식의 단점을 보완하기 위해 나왔습니다.</p>\n<p>모든 트래픽은 L4 노드 프록시를 통해 프록시되고 애플리케이션은 Envoy 프록시 라우팅 사용을 “선택하여” L7 기능을 사용할 지 말 지 결정 가능합니다.</p>\n<h2>둘 중 뭘 선택해야할까?</h2>\n<p>기본적으로 ambient(주변) 방식이 사이드카 방식의 단점을 보완하기 나온 것이기 때문에 대부분의 면에서 더 좋습니다.</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>사이드카</th>\n<th>앰비언트</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>자원 활용</td>\n<td>모든 파드에 떠야해서 비효율적</td>\n<td>필요한 만큼만 사용 가능하며 scale-out도 가능함</td>\n</tr>\n<tr>\n<td>지연 시간</td>\n<td>0.63ms-0.88ms</td>\n<td>Ambient: 0.16ms-0.20ms<br>Waypoint: 0.40ms-0.50ms</td>\n</tr>\n<tr>\n<td>지원</td>\n<td>멀티 클러스터 포함 지원</td>\n<td>Beta 버전, 단일 클러스터 지원</td>\n</tr>\n</tbody>\n</table>\n<p>앰비언트 방식이 대체로 효율적이고 좋지만, 가장 치명적인 단점은 아직 beta 버전이라는 점입니다.</p>\n<p>때문에 지원하지 않거나 부족한 기능들이 다소 존재합니다.</p>\n<h1>트래픽 관리</h1>\n<p>그래서 Istio를 사용해서 어떤 트래픽 관리를 할 수 있을까요?</p>\n<p>istio를 사용하면 A/B 테스트, 카나리 배포, 백분율 기반 트래픽 분할은 기본이고, 서킷브레이커, timeout, 재시도 정책 같은 애플리케이션 서비스 레벨의 구성을 단순화 할 수 있습니다.</p>\n<p>앞서 말했듯 istio의 트래픽 관리는 Envoy가 담당합니다.</p>\n<p><img src=\"/658f9a75b34ad6bc1cb31bb602d2e3c1/arch.svg\" alt=\"arch.svg\"></p>\n<h2>Virtual Service &#x26; Destination Rule</h2>\n<h3>Virtual Service</h3>\n<p>Virtual Service와 Destination Rule은 istio의 핵심 기능입니다.</p>\n<p>Virtual Service는 Istio에서 제공하는 연결을 기반으로 라우팅하는 방법을 구성할 수 있습니다.</p>\n<blockquote>\n<p>여기서 “Virtual”이라는 단어를 붙인 이유는 “추상적인 트래픽 관리 계층”이라는 의미를 포함하고 있기 때문입니다.</p>\n</blockquote>\n<p>아래 예시를 보면서 설명하면 훨씬 빠르게 이해할 수 있습니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"yaml\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">apiVersion</span><span class=\"mtk1\">: </span><span class=\"mtk8\">networking.istio.io/v1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">kind</span><span class=\"mtk1\">: </span><span class=\"mtk8\">VirtualService</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">metadata</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">name</span><span class=\"mtk1\">: </span><span class=\"mtk8\">reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">spec</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">hosts</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk8\">reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">http</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk4\">match</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    - </span><span class=\"mtk4\">headers</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">end-user</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk4\">exact</span><span class=\"mtk1\">: </span><span class=\"mtk8\">jason</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">route</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    - </span><span class=\"mtk4\">destination</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">host</span><span class=\"mtk1\">: </span><span class=\"mtk8\">reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">subset</span><span class=\"mtk1\">: </span><span class=\"mtk8\">v2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk4\">route</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    - </span><span class=\"mtk4\">destination</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">host</span><span class=\"mtk1\">: </span><span class=\"mtk8\">reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">subset</span><span class=\"mtk1\">: </span><span class=\"mtk8\">v3</span></span></span></code></pre>\n<p>Virtual Service의 라우팅 규칙은 위에서부터 아래로 우선순위를 가집니다.</p>\n<p>따라서 맨 위 규칙인 <code class=\"language-text\">headers의 end-user가 \"jason\"이면 reviews/v2로 트래픽을 보내라</code> 를 먼저 거치고 이게 아니라면, 남은 모든 트래픽을 <code class=\"language-text\">reviews/v3</code>로 보내는 것입니다.</p>\n<p>이렇게 Virtual Service를 적용하면 모든 프록시(envoy)에 이 routing rule이 적용된다. 그럼에도 성능에 문제가 없는 이유는 Envoy에서 효율적인 라우팅 규칙을 사용하기 때문입니다.</p>\n<ul>\n<li>indexing 및 트리 구조 (요청의 호스트 검색이 빠름)</li>\n<li>Host 기반 룰 필터링 (호스트가 확인되면 관련 룰을 훑음)</li>\n</ul>\n<p>이렇게 모든 프록시에 적용함으로서 룰을 중앙화 하지 않아 트래픽이 중앙 제어 장치로 한 번 더 거쳐 갈 필요가 없다는 장점도 생깁니다.</p>\n<p>또, 아래처럼 weight을 주어 트래픽을 분배할 수도 있습니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"yaml\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">spec</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">hosts</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk8\">reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">http</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk4\">route</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    - </span><span class=\"mtk4\">destination</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">host</span><span class=\"mtk1\">: </span><span class=\"mtk8\">reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">subset</span><span class=\"mtk1\">: </span><span class=\"mtk8\">v1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">weight</span><span class=\"mtk1\">: </span><span class=\"mtk7\">75</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    - </span><span class=\"mtk4\">destination</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">host</span><span class=\"mtk1\">: </span><span class=\"mtk8\">reviews</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">subset</span><span class=\"mtk1\">: </span><span class=\"mtk8\">v2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">weight</span><span class=\"mtk1\">: </span><span class=\"mtk7\">25</span></span></span></code></pre>\n<h3>Destination Rule</h3>\n<p>다음으로 Destination Rule은 트래픽이 서비스에 도착했을 때, 어떻게 트래픽을 처리할 지 세부 동작을 결정하는 것입니다.</p>\n<p>k8s를 예시로 들자면, 트래픽을 받은 svc가 여러 pod에 트래픽을 어떻게 분배할 지 결정하는 로직이라고 생각하시면 됩니다.</p>\n<ul>\n<li>트래픽 분배 방식은 아래와 같이 다양하게 존재힙니다.\n<ul>\n<li>Random: 요청이 풀의 인스턴스로 임의로 전달됩니다.</li>\n<li>Weighted: 요청은 특정 비율에 따라 풀의 인스턴스로 전달됩니다.</li>\n<li>Round robin: 요청이 순서대로 각 인스턴스로 전달됩니다.</li>\n<li>Consistent hash: HTTP 헤더, 쿠키 또는 기타 속성을 기반으로 소프트 세션 선호도를 제공합니다.</li>\n<li>Ring hash: <a href=\"https://www.metabrew.com/article/libketama-consistent-hashing-algo-memcached-clients\" target=\"_blank\" rel=\"nofollow\">Ketama 알고리즘을</a> 사용하여 업스트림 호스트에 일관된 해시를 구현합니다.</li>\n<li>Maglev: <a href=\"https://research.google/pubs/maglev-a-fast-and-reliable-software-network-load-balancer/\" target=\"_blank\" rel=\"nofollow\">Maglev 문서에</a> 설명된 대로 업스트림 호스트에 일관된 해싱을 구현합니다.</li>\n</ul>\n</li>\n</ul>\n<p>아래는 Destination Rule의 예시입니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"yaml\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">apiVersion</span><span class=\"mtk1\">: </span><span class=\"mtk8\">networking.istio.io/v1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">kind</span><span class=\"mtk1\">: </span><span class=\"mtk8\">DestinationRule</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">metadata</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">name</span><span class=\"mtk1\">: </span><span class=\"mtk8\">my-destination-rule</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">spec</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">host</span><span class=\"mtk1\">: </span><span class=\"mtk8\">my-svc</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">trafficPolicy</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">loadBalancer</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">simple</span><span class=\"mtk1\">: </span><span class=\"mtk8\">RANDOM</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">subsets</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk4\">name</span><span class=\"mtk1\">: </span><span class=\"mtk8\">v1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">labels</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">version</span><span class=\"mtk1\">: </span><span class=\"mtk8\">v1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk4\">name</span><span class=\"mtk1\">: </span><span class=\"mtk8\">v2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">labels</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">version</span><span class=\"mtk1\">: </span><span class=\"mtk8\">v2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">trafficPolicy</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">loadBalancer</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">simple</span><span class=\"mtk1\">: </span><span class=\"mtk8\">ROUND_ROBIN</span></span></span></code></pre>\n<p>그림을 보면 알 수 있듯이 실제 트래픽 분배 방식을 결정하는건 Envoy입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b40176a6cc385d18d9e54d8ca38151bd/5b89d/image3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.08333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACXklEQVQoz6WSS08TURiGu+IHKMYL0tIbtJTSBHFBbDTBgqQikLhwpwsVF4Tfob9CE7mJiSvEQCKQGpVEIptGAoQUSutMx7mcM2cuPacz08+0U1JI1I3P6iRfnnyX83ps2y6VSoIgcBwvipJuGCohGGN0FoyxqqqEEL0OpVSSJA9jDCEky3KJ5wiSwKmAY8M/qVarAIAQ8lBKDcMQhNLBUfHrXunLvpA9ODZ0jWiaJEmKotSrAs/zhUKB53lZljVNAwBFUWqyqhIsi9mC8nz18MXHnwufdvjC0XGhuLu7K4oixjifzxuGgRDSdZ0xhjFuyOVymRAiSSIn/NreO9rey+/s5yqMAgDGuFKpuBNqmkYpZYypqooQasgAsPp+5cFEemRsPD08di89MXr3fmpobGvrO8dxum4AgGVZpmnqum6aJqXUcZymPDv7pv1ql78j1tbWeeli8MrlUOt539paxnEcSpl7IVaH1rFtuynPz78NhxJDqdFbN4d7YtfDoV6fN5rJfLZtGyFECMnlchzHHR4eFotFWZYJIU15bm4xGIinbo9e60smegeCgbi3PbKxngGAcrnMGON53l2YMWZZlqqqZzr7vNHkjVSkqy/g73Hl9brsTkgpVU4QRfGMPDOz4G2PJJNDse7+YCDe6LzRlP8Ykob86uVrnzc6cmd8cDCdSAyEQ71+f2xp6YObQeUUuI4bUlmWa/Li4ruWlnPBQDzW3R+N9HWGExdaO5aXVwDANE12isoJlmVVq9WavLn57dHDyWeT00+eTE0+na49Hk9lsz8AwP3SvyXcA//Bb4JB1PkfSBEiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b40176a6cc385d18d9e54d8ca38151bd/a59e9/image3.webp 192w,\n/static/b40176a6cc385d18d9e54d8ca38151bd/0ca9f/image3.webp 384w,\n/static/b40176a6cc385d18d9e54d8ca38151bd/dc9b9/image3.webp 768w,\n/static/b40176a6cc385d18d9e54d8ca38151bd/e2c2f/image3.webp 1152w,\n/static/b40176a6cc385d18d9e54d8ca38151bd/3c106/image3.webp 1410w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b40176a6cc385d18d9e54d8ca38151bd/3b721/image3.png 192w,\n/static/b40176a6cc385d18d9e54d8ca38151bd/66595/image3.png 384w,\n/static/b40176a6cc385d18d9e54d8ca38151bd/fe486/image3.png 768w,\n/static/b40176a6cc385d18d9e54d8ca38151bd/d2d74/image3.png 1152w,\n/static/b40176a6cc385d18d9e54d8ca38151bd/5b89d/image3.png 1410w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b40176a6cc385d18d9e54d8ca38151bd/fe486/image3.png\"\n            alt=\"image.png\"\n            title=\"image.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>그럼 이런 의문이 들 수 있는데요. (저는 이런 의문이 들었습니다 ㅎㅎ…)</p>\n<blockquote>\n<p>src Envoy에서 트래픽 전달 방식(RR 같은)을 결정하면 각각의 src Envoy 프록시가 독립적으로 트래픽 분배를 결정하기 때문에 아래와 같은 문제가 생길 수 있지 않을까?</p>\n<ol>\n<li>\n<p>트래픽 5개가 podA로 들어오고, podA는 각각의 envoy에서 RR 방식을 사용하기 때문에 모두 podB1으로 트래픽을 보낸다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"yaml\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">podA1 -&gt; podB1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">podA2 -&gt; podB1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">podA3 -&gt; podB1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">podA4 -&gt; podB1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">podA5 -&gt; podB1</span></span></span></code></pre>\n</li>\n<li>\n<p>다음으로 또 트래픽 5개가 들어오고, 모두 RR을 사용하기 때문에 다음 순서인 podB2에 모두 트래픽을 보낸다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"yaml\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">podA1 -&gt; podB2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">podA2 -&gt; podB2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">podA3 -&gt; podB2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">podA4 -&gt; podB2</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk8\">podA5 -&gt; podB2</span></span></span></code></pre>\n</li>\n</ol>\n<p>결국 RR이 제대로 동작하지 않게 된다.</p>\n</blockquote>\n<p>이런 문제는 src Envoy 프록시들이 각각 상태를 공유하지 않기 때문에 충분히 발생할 수 있는 일이라고 합니다.</p>\n<p>그래서 Envoy에선 이런 문제를 해결하기 위해 <code class=\"language-text\">Randomized LB Seed</code> 같은 랜덤 시드로 동시에 한 파드에 몰리지 않게 하거나 <code class=\"language-text\">LEAST_REQUEST</code> 같은 방식(현재 연결 수가 가장 적은 Pod를 선택)으로 문제를 해결한다고 합니다.</p>\n<h2>Gateways</h2>\n<p>지금까지는 클러스터 내부에서의 트래픽 흐름만 봤다면 이번엔 클러스터 외부에서 들어오는 트래픽에 대해 살펴볼 차례입니다.</p>\n<p>지금까지 살펴본 방식이라면 아래 같은 경우엔 어떻게 될 지 궁금하실 수 있을텐데요.</p>\n<p>분명 아까 전에 사이드카 방식은 보내는 쪽에서 Virtual Service를 적용해 weight을 분산시킨다고 했습니다.</p>\n<p>그럼 Ingress Gateways로 들어오는 트래픽은 어떻게 weight을 조절할 수 있을까요?</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b0da7532a8be5ac6022b6198868a9f05/fe147/image2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 68.75%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAACVElEQVQoz6WS3UsUURiHF+oPMIoiXZVaV7T8JHf9KDS1O/+gED/KvJCVqBsvFLRIuuomCIWukpK6SpCo1GgdZ3bnzDm7M3Nm5owzOzNn5g13ltCgbnouDhwOD7/fy3sSvu/LslwqlZCCFUxkhApnKRaLCCFFUcrlsqZpuq6bpglVEkEQYIwJIQQVuOcARPAXoiiKT8ZYTfaqyaJU2N7Hm7vy1s4+wVjVNEVRGGNxZj6fFwRB0zTDMCoVT6c0AgijKOG6LtV1PwjffDfXdui7vZJ7zFRNQwhxzgkhtm37vu95HkRR/vBQkQsljOIKCc759vvtl+svVp+tL688X15e3dh467oVXdejKOKcW5Zl27bjOJbFQh4IxPq4j3ZFuofMBADM3p9NNTbUN6WTV9OXLjbfvJE5OhIlSQqCAADCMOScB0Hg+wFAuPm1PPf6y8NXn9c+KSfyzMx8Z8dAb/dQS6qruak9m7mLMXGcY8/zGWOEkHwVVVVd1ylpxrefIlLNErVP5MnJB22tPUODo+mWrsZkW9+tYYwJ59wwDEEQKKUAwDkHAFEUFSQXC1JtZgCYmpq7cvlaf3ZkcGC0syOb6RtWEI6fwzA0DMM0TUqpWcWtVFRN+1O+c/veQP94S6o703eSfHqx8dhhGMZXy7JqewaA6elHDfWt42MT42MTvT1D/dmRg4MfjFmqqsZfilIa55umaVmWYRin5Km58+fqUtc7m5LtF+qSrekeSSoCgO/7wVl4lbhRTd7a+jA/n1vMPc3lniwsPF5aWmHM/l37HyTgP/gFoHu1zTfeBX8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/b0da7532a8be5ac6022b6198868a9f05/a59e9/image2.webp 192w,\n/static/b0da7532a8be5ac6022b6198868a9f05/0ca9f/image2.webp 384w,\n/static/b0da7532a8be5ac6022b6198868a9f05/dc9b9/image2.webp 768w,\n/static/b0da7532a8be5ac6022b6198868a9f05/e2c2f/image2.webp 1152w,\n/static/b0da7532a8be5ac6022b6198868a9f05/f3efb/image2.webp 1536w,\n/static/b0da7532a8be5ac6022b6198868a9f05/50ff9/image2.webp 1604w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/b0da7532a8be5ac6022b6198868a9f05/3b721/image2.png 192w,\n/static/b0da7532a8be5ac6022b6198868a9f05/66595/image2.png 384w,\n/static/b0da7532a8be5ac6022b6198868a9f05/fe486/image2.png 768w,\n/static/b0da7532a8be5ac6022b6198868a9f05/d2d74/image2.png 1152w,\n/static/b0da7532a8be5ac6022b6198868a9f05/e8464/image2.png 1536w,\n/static/b0da7532a8be5ac6022b6198868a9f05/fe147/image2.png 1604w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/b0da7532a8be5ac6022b6198868a9f05/fe486/image2.png\"\n            alt=\"image.png\"\n            title=\"image.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Gateways는 클러스터 외부의 트래픽을 다루는 만큼 사이드카 Envoy 프록시가 아니라, 독립형 Envoy 프록시 형태로 사용됩니다.</p>\n<p>여기서 Virtual Service와 헷갈릴 수 있는데, Gateway 리소스는 어떤 트래픽이 클러스터 내부로 들어오려 할 때, <strong>“이 트래픽이 클러스터 내부로 들어올 수 있는지”</strong> 에 대한 조건을 결정하는 리소스입니다.</p>\n<p>예시를 보면서 확인해보겠습니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"yaml\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">apiVersion</span><span class=\"mtk1\">: </span><span class=\"mtk8\">networking.istio.io/v1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">kind</span><span class=\"mtk1\">: </span><span class=\"mtk8\">Gateway</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">metadata</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">name</span><span class=\"mtk1\">: </span><span class=\"mtk8\">ext-host-gwy</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">spec</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">selector</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">app</span><span class=\"mtk1\">: </span><span class=\"mtk8\">my-gateway-controller</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">servers</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk4\">port</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">number</span><span class=\"mtk1\">: </span><span class=\"mtk7\">443</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">name</span><span class=\"mtk1\">: </span><span class=\"mtk8\">https</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">protocol</span><span class=\"mtk1\">: </span><span class=\"mtk8\">HTTPS</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">hosts</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    - </span><span class=\"mtk8\">ext-host.example.com</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk4\">tls</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">mode</span><span class=\"mtk1\">: </span><span class=\"mtk8\">SIMPLE</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk4\">credentialName</span><span class=\"mtk1\">: </span><span class=\"mtk8\">ext-host-cert</span></span></span></code></pre>\n<p>Gateway에선 단순히 hosts와 port 등으로 방화벽 역할만 수행합니다.</p>\n<p>위와 같이 Gateway 설정으로 들어온 트래픽이 어디로 향할지는 Virtual Service에서 결정합니다.</p>\n<p>만약 아래와 같이 VirtualService를 설정하면 <code class=\"language-text\">ext-host-gwy</code> 라는 게이트웨이에서 들어온 <code class=\"language-text\">ext-host.example.com</code> 도메인을 가진 트래픽이 어떤 svc로 향하는지 알 수 있습니다.</p>\n<pre class=\"grvsc-container default-dark\" data-language=\"yaml\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">apiVersion</span><span class=\"mtk1\">: </span><span class=\"mtk8\">networking.istio.io/v1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">kind</span><span class=\"mtk1\">: </span><span class=\"mtk8\">VirtualService</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">metadata</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">name</span><span class=\"mtk1\">: </span><span class=\"mtk8\">virtual-svc</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">spec</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">hosts</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk8\">ext-host.example.com</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">gateways</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk8\">ext-host-gwy</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk4\">http</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  - </span><span class=\"mtk4\">route</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    - </span><span class=\"mtk4\">destination</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">host</span><span class=\"mtk1\">: </span><span class=\"mtk8\">my-backend-service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk4\">port</span><span class=\"mtk1\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">          </span><span class=\"mtk4\">number</span><span class=\"mtk1\">: </span><span class=\"mtk7\">8080</span></span></span></code></pre>\n<p>위 내용을 그림으로 표현하면 아래와 같습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4532eed95d2f7bf5d38975fc7402d318/1b646/image4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 71.35416666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAACzklEQVQoz5WSbUgTcRzH96ogwxe6uzQ1t+nc9M6223bq5gM+IhlEIb1KjXKpy5y+sV4UBZmWs6cXBfmiKAt8IWUYCWkmEdULxR6gFIbT83actjm3e3K33fmPrRdSBNHnxQ9+X/i8+fJVAABEUaQoiiAIkiSXlpaWCWKVJGVRlME/UPwZbG0BAARyhSGWAQA/aO8q5aUoKhAI+P1+n8+3vr7OMEwoFIpGowpJkliW5Xmei8OyXDQamV5YG5khX3zyDn/0vP3mjYhhSZIYhuE4TojDsqwgCAqO42iapihqhSRJ0uv2uGcXv9x943G98lyfWBx4TTz64A0EAisr5OrqmtvtXlhYoCiKpmme5xUsy9I07V/3M0Fmg2HCJOHzuEe/M0NfhYdzwTvv6JfzIQCALEuyLG9uChzHSZLEx1EIghDY2Pg8Mzs29vTZ87HJ8Ynpiann41NDI+OT7+fmibXO052OM23N9vbGRvvxppaTJxxH6xuePB6OFSZLEgDAdcUFKeHUNC0Ma2BIk75Xm5gAtzucYZ4vworSMjTK5EwYUsOQOjUle+eOpEsXe2OyFJf7rt5AkcLCgnI0D0cR3LC/CIY1TudZURSt1upiWzVuKTOZSowGK5KHK5MzB1y3t+Wenv4sDVpYUJ6rx7XZBr3OBClVzo5uURQL8DKLudSEFefqzWoVmqM1JCft67928zc5PS2novyAGSvV6bAsTT6kzHR2dEciEYu5xIQVGw3WvFyzNjtfr8MgpcrVf2tb7u0dUKuQYluVxVyKGW0ogu+BNV2d5yKRiF5vykjLsVkrjUYrilhRBIeUmX29A9vyhfOXE3ZBKILn6s0Z6Tq1CkncnWK3t0uSdLCu3matrq09XFNzqKrySEV5HYbZBu/dj7ctxyY8MjLacKzZ0dbZ2uJsbXE6HF1NjacGBx8AAEIhJhgMBWPE7q83HA7/bdv/w0+ogC0J13cywQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/4532eed95d2f7bf5d38975fc7402d318/a59e9/image4.webp 192w,\n/static/4532eed95d2f7bf5d38975fc7402d318/0ca9f/image4.webp 384w,\n/static/4532eed95d2f7bf5d38975fc7402d318/dc9b9/image4.webp 768w,\n/static/4532eed95d2f7bf5d38975fc7402d318/e2c2f/image4.webp 1152w,\n/static/4532eed95d2f7bf5d38975fc7402d318/f3efb/image4.webp 1536w,\n/static/4532eed95d2f7bf5d38975fc7402d318/49123/image4.webp 1817w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/4532eed95d2f7bf5d38975fc7402d318/3b721/image4.png 192w,\n/static/4532eed95d2f7bf5d38975fc7402d318/66595/image4.png 384w,\n/static/4532eed95d2f7bf5d38975fc7402d318/fe486/image4.png 768w,\n/static/4532eed95d2f7bf5d38975fc7402d318/d2d74/image4.png 1152w,\n/static/4532eed95d2f7bf5d38975fc7402d318/e8464/image4.png 1536w,\n/static/4532eed95d2f7bf5d38975fc7402d318/1b646/image4.png 1817w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/4532eed95d2f7bf5d38975fc7402d318/fe486/image4.png\"\n            alt=\"image.png\"\n            title=\"image.png\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk7 { color: #B5CEA8; }\n  .default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"title":"istio","summary":"istio docs 살펴보기","date":"2024.11.19.","categories":["etc","network"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAAUABQDASIAAhEBAxEB/8QAGgABAAEFAAAAAAAAAAAAAAAAAAYEBQcICf/EABgBAAMBAQAAAAAAAAAAAAAAAAIDBQcI/9oADAMBAAIQAxAAAAHD89u+7HQuY80xfm1kiFlEQwf/xAAZEAACAwEAAAAAAAAAAAAAAAAFBgADBAL/2gAIAQEAAQUChsFcHqiWLwl2N86XmFCmfRoyXEzxwz1P/8QAHxEBAQACAQQDAAAAAAAAAAAAAQIDBDEQERIhIiNx/9oACAEDAQE/AdbSM+ptZm4m8ctYYaCrcTFZQFO/10+Pr5Wdjh6F2DBdEV7qSnxU4WeF/en/xAAfEQADAAICAgMAAAAAAAAAAAABAgMEBRAREiExMkH/2gAIAQIBAT8B2G3OHs9diLKrztRUy6LNmnFckUTGYsFIBFpA07I8JN2fsODKTOtWlM1T0lCimig/IVyPJQf0A++P/8QAJhAAAgIBAgUEAwAAAAAAAAAAAgMBBAUSMQAQERMhBhRxcjJRgv/aAAgBAQAGPwLjB2S6lWzmEp5ascxsbIldyv8Aau8fntNVM78sdXylhVbFpZ73Im2ZjXVqTDTrBAxJmy0WhGkIkoA2HsHCZq3qwZX0++zdqJYDapHWZacNmmqLCkxPcqkpyVj5I0KEY88l2alh9Wwotan1nMQ5ZRsQNUQmM/BRx1y2YyeS6fiNy69yx+qZPsj/ACuP3vy//8QAHBABAAMAAgMAAAAAAAAAAAAAAQARIRBRMWGh/9oACAEBAAE/IZkBISwRoNOvZlmVlMnDoysac2xmlGAvk4Adgw4Hgbwx47++o2ZDGY4FH3tWraVLx//aAAwDAQACAAMAAAAQ0AiA/8QAGBEBAAMBAAAAAAAAAAAAAAAAAQARIRD/2gAIAQMBAT8QcKEv4CgiItAVMUhFE1gEhBQQoOc//8QAGBEBAAMBAAAAAAAAAAAAAAAAAQAQESH/2gAIAQIBAT8QeL56DHNhxaRyHUR2w68IAgCBRwr/xAAdEAEBAAEEAwAAAAAAAAAAAAABEQAQITFhQaHw/9oACAEBAAE/EAqFlQrwd43ToIBR3EGAGK6G27BkJCINRUJUUQoXm+KIhD7+7xxG5r6s884loqSyEgCElrdyukDP/9k="},"images":{"fallback":{"src":"/static/a738c6c1e90607d05a38dbd23cd61ee9/10998/istio.jpg","srcSet":"/static/a738c6c1e90607d05a38dbd23cd61ee9/93e3f/istio.jpg 100w,\n/static/a738c6c1e90607d05a38dbd23cd61ee9/839ae/istio.jpg 200w,\n/static/a738c6c1e90607d05a38dbd23cd61ee9/10998/istio.jpg 400w","sizes":"(min-width: 400px) 400px, 100vw"},"sources":[{"srcSet":"/static/a738c6c1e90607d05a38dbd23cd61ee9/e64f1/istio.webp 100w,\n/static/a738c6c1e90607d05a38dbd23cd61ee9/8b00d/istio.webp 200w,\n/static/a738c6c1e90607d05a38dbd23cd61ee9/9c0a1/istio.webp 400w","type":"image/webp","sizes":"(min-width: 400px) 400px, 100vw"}]},"width":400,"height":400}},"publicURL":"/static/a738c6c1e90607d05a38dbd23cd61ee9/istio.jpeg"}}}}]}},"pageContext":{"slug":"/infra/2024-11-19-istio/"}},"staticQueryHashes":["2518467932","429584967"]}