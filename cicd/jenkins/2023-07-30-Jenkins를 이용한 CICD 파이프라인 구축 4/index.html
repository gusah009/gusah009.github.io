<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.7"/><meta data-react-helmet="true" name="description" content="k8s와 연동하기"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1.0"/><meta data-react-helmet="true" http-equiv="Content-Type" content="text/html;charset=UTF-8"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="Jenkins를 이용한 CI/CD 파이프라인 구축 4"/><meta data-react-helmet="true" property="og:description" content="k8s와 연동하기"/><meta data-react-helmet="true" property="og:image" content="/static/6a3b9dce28b4687f9f583de058b08be4/choonsik_jenkins.jpeg"/><meta data-react-helmet="true" property="og:url"/><meta data-react-helmet="true" property="og:site_name" content="Jenkins를 이용한 CI/CD 파이프라인 구축 4"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Jenkins를 이용한 CI/CD 파이프라인 구축 4"/><meta data-react-helmet="true" name="twitter:description" content="k8s와 연동하기"/><meta data-react-helmet="true" name="twitter:image" content="/static/6a3b9dce28b4687f9f583de058b08be4/choonsik_jenkins.jpeg"/><meta data-react-helmet="true" name="twitter:site" content="@사용자이름"/><meta data-react-helmet="true" name="twitter:creator" content="@사용자이름"/><title data-react-helmet="true">Jenkins를 이용한 CI/CD 파이프라인 구축 4</title><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="canonical" href="https://gusah009.github.io/cicd/jenkins/2023-07-30-Jenkins를%20이용한%20CICD%20파이프라인%20구축%204/" data-baseprotocol="https:" data-basehost="gusah009.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><main class="flex flex-col h-full"><div><div class="hidden z-40 lg:flex lg:w-64 lg:flex-col lg:fixed lg:inset-y-0"><div class="absolute top-0 right-0 -mr-12 pt-2"><button type="button" class="-ml-[90px] flex items-center justify-center h-8 w-8 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white"><span class="sr-only">Close sidebar</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="h-6 w-6 text-black"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><div class="flex flex-col flex-grow bg-white shadow-lg shadow-slate-200 overflow-y-auto"><div class="w-full flex flex-col items-center px-4 mt-14 "><a href="/"><img class="w-20 h-20 mb-3 rounded-md" src="https://avatars.githubusercontent.com/u/26597702?v=4" alt="profile"/></a><div class=" text-slate-900 text-md font-bold mb-5">gusah009</div><div class="flex space-x-6"><a href="https://devblog-gusah009.notion.site/gusah009-1f41013097914875a99b6af4134bce9e" target="_blank"><svg class="fill-slate-900 hover:fill-slate-500 stroke-slate-900 stroke-0" xmlns="http://www.w3.org/2000/svg" focusable="false" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M4.459 4.208c.746.606 1.026.56 2.428.466l13.215-.793c.28 0 .047-.28-.046-.326L17.86 1.968c-.42-.326-.981-.7-2.055-.607L3.01 2.295c-.466.046-.56.28-.374.466zm.793 3.08v13.904c0 .747.373 1.027 1.214.98l14.523-.84c.841-.046.935-.56.935-1.167V6.354c0-.606-.233-.933-.748-.887l-15.177.887c-.56.047-.747.327-.747.933zm14.337.745c.093.42 0 .84-.42.888l-.7.14v10.264c-.608.327-1.168.514-1.635.514c-.748 0-.935-.234-1.495-.933l-4.577-7.186v6.952L12.21 19s0 .84-1.168.84l-3.222.186c-.093-.186 0-.653.327-.746l.84-.233V9.854L7.822 9.76c-.094-.42.14-1.026.793-1.073l3.456-.233l4.764 7.279v-6.44l-1.215-.139c-.093-.514.28-.887.747-.933zM1.936 1.035l13.31-.98c1.634-.14 2.055-.047 3.082.7l4.249 2.986c.7.513.934.653.934 1.213v16.378c0 1.026-.373 1.634-1.68 1.726l-15.458.934c-.98.047-1.448-.093-1.962-.747l-3.129-4.06c-.56-.747-.793-1.306-.793-1.96V2.667c0-.839.374-1.54 1.447-1.632z"></path></svg></a><a href="https://github.com/gusah009" target="_blank"><svg class="fill-slate-900 hover:fill-slate-500 stroke-slate-900" stroke-width="0" viewBox="0 0 496 512" height="32" width="32" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="mailto:gusah009@naver.com"><svg class="fill-slate-900 hover:fill-slate-500 stroke-slate-900" stroke-width="0" viewBox="0 0 24 24" height="32" width="32" xmlns="http://www.w3.org/2000/svg"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></svg></a></div></div><div class="w-full px-3 pt-8"><button class="flex mt-1 w-full justify-between ui-not-open:rounded-md ui-open:rounded-t-md px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200" id="headlessui-disclosure-button-:R9l9:" type="button" aria-expanded="false" data-headlessui-state=""><span>JAVA</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class=" h-5 w-5 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg></button><button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="ml-4 border-l-2"></div><button class="flex mt-1 w-full justify-between ui-not-open:rounded-md ui-open:rounded-t-md px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200" id="headlessui-disclosure-button-:Ral9:" type="button" aria-expanded="false" data-headlessui-state=""><span>PROJECTS</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class=" h-5 w-5 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg></button><button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="ml-4 border-l-2"></div><button class="flex mt-1 w-full justify-between ui-not-open:rounded-md ui-open:rounded-t-md px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200" id="headlessui-disclosure-button-:Rbl9:" type="button" aria-expanded="false" data-headlessui-state=""><span>CICD</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class=" h-5 w-5 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg></button><button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="ml-4 border-l-2"></div><button class="flex mt-1 w-full justify-between ui-not-open:rounded-md ui-open:rounded-t-md px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200" id="headlessui-disclosure-button-:Rcl9:" type="button" aria-expanded="false" data-headlessui-state=""><span>ETC</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class=" h-5 w-5 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg></button><button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="ml-4 border-l-2"></div><button class="flex mt-1 w-full justify-between ui-not-open:rounded-md ui-open:rounded-t-md px-4 py-2 text-left text-sm font-medium text-slate-900 hover:bg-slate-200" id="headlessui-disclosure-button-:Rdl9:" type="button" aria-expanded="false" data-headlessui-state=""><span>일상</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class=" h-5 w-5 text-slate-500"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"></path></svg></button><button type="button" aria-hidden="true" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0"></button><div class="ml-4 border-l-2"></div></div></div></div><div class=" lg:pl-64 flex flex-col flex-1"><div class="sticky top-0 z-10 flex-shrink-0 flex h-12 bg-white shadow"><button type="button" class="px-4 border-r border-gray-200 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500 lg:hidden"><span class="sr-only">Open sidebar</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h7"></path></svg></button><button type="button" class="px-4 border-r border-gray-200 text-gray-500 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500 hidden "><span class="sr-only">Open sidebar</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h7"></path></svg></button><div class="flex-1 flex"><a class="flex items-center" style="margin-left:0%" href="/cicd/jenkins/2023-07-30-Jenkins를 이용한 CICD 파이프라인 구축 4/"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained w-8 drop-shadow-md"><div style="max-width:109px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;99.99999999999999&#x27; width=&#x27;109&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAADyklEQVQ4y12UbUxbZRTHT7l8YXYtFO86p9PV6JClC02gA1O78lKcvPRFHBjDlBUTSOSLEU0wxJjosg/ug0uWKbBk2RhIF5ORkfoCuuk+bdGgodGETLcuEuvoDKyktfS+PH/z3Aul5dyce2+ePOd3zz3nPH8iIqqocBAA6u0dJputUiDdnjOby19ub38jEQiE4PeHVL//uBII9MLj8V8gImdZmWUn37hjh0mwWHZrHMoHOp2NBputki9V+3zHl/v6hnHnToatroIlEsDyMpBKgV269B06OvrhcrV8xuO4lZc/VlRRUaXD7HYn+XzHNuGeUGgwHo0moKrIqqrKAAUAf3KXkc1ClSRIo6NXeLajomgt5bEOh4tyaTqd9YIoPkEWy67Jc+dmAWBdVdchSTKTZQUsZ2CKIkNRMuzhQyg+X4inaOeMvXufETRgdfVhA5FAe/bs8w8MfHQ3Go2DMagAGLYZJ26ss2wWbHLymtLQEJwgorJc/Q4d8gjFxTvJat03Nj4+zQOyYCpSqTSGhj7AyZOnNJCqqhp0bu4aenr6sLCwoCaTQGvrMZ5lZQ5YW+spMhiMJIpPnQqHL/MYmWewsrqC/fur4HY3a0BF0YGnT58FUQmbmYlozTpy5LU1Ino2B6ypcQsGwyNktdo+nZr6UgNm4sDfC0nU1tTDH+gCU7cyHBs7D3HXk7hy4VsWjwGtbd1pInqa8o1naDLt/mRiIqwB7/6cwOL1fxCbTyCx/C8Yv/T6IZVO4favfyE+n2J//C7hpZZX/+NNNhr1MhYTkVlv+/PnZ2a+0oDvDr6Prs7XcXvxz1wzNj2/R7GYzDo730JV1Qv36uqaD1J9ve/DxsbgFBF9fObMCN+kyLLMYveWcOPGTbwzOIRkci2/w5sNYrzZS0tZ3L8PeXExhbq6JlB//zCmp39CW1sQs7PfawG8ViMjUzhx4iwymfUCWOH46Ldo9DdEIl/D5Wq6Sd3db0srK/pc6ftyc7Z99vJ/W7NUSsWtW79IHs+L10tKHv28oaGlmHp63kMmA1mWM1AU/SRwHs+S+3YYf9P+FjJbW4Pc3t7LZ/Ag78GBA9UCNTcfnQ6Hf+AxEmPZja8DuXNW6BsPWds/Pj4Hr/eVy6WlZpGLhN3uNGjq43R6r4bDP/KKrPPjlCcGyHNNHBiTNNjFi3NwOA6HN6aERPHxopx8EVFJU1PH1a6uAUQi80inwbhUPXhQ6HwtnYbMM8uHGY3mLT00mco1QRWEIpGIXF7v0W+4iHIx9fs1Yd10xteCwTfhdrd9sQUrLRDX/wGSgXZ6erYz6gAAAABJRU5ErkJggg==" alt=""/><picture><source type="image/webp" data-srcset="/static/e9127b8e576402d43e65260030c6fa43/6ad34/ghost.webp 27w,/static/e9127b8e576402d43e65260030c6fa43/b13ee/ghost.webp 55w,/static/e9127b8e576402d43e65260030c6fa43/e1ec8/ghost.webp 109w,/static/e9127b8e576402d43e65260030c6fa43/6cadb/ghost.webp 218w" sizes="(min-width: 109px) 109px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 109px) 109px, 100vw" decoding="async" loading="lazy" data-src="/static/e9127b8e576402d43e65260030c6fa43/0d876/ghost.png" data-srcset="/static/e9127b8e576402d43e65260030c6fa43/d824c/ghost.png 27w,/static/e9127b8e576402d43e65260030c6fa43/fa736/ghost.png 55w,/static/e9127b8e576402d43e65260030c6fa43/0d876/ghost.png 109w,/static/e9127b8e576402d43e65260030c6fa43/8971a/ghost.png 218w" alt="Progress Image"/></picture><noscript><picture><source type="image/webp" srcSet="/static/e9127b8e576402d43e65260030c6fa43/6ad34/ghost.webp 27w,/static/e9127b8e576402d43e65260030c6fa43/b13ee/ghost.webp 55w,/static/e9127b8e576402d43e65260030c6fa43/e1ec8/ghost.webp 109w,/static/e9127b8e576402d43e65260030c6fa43/6cadb/ghost.webp 218w" sizes="(min-width: 109px) 109px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 109px) 109px, 100vw" decoding="async" loading="lazy" src="/static/e9127b8e576402d43e65260030c6fa43/0d876/ghost.png" srcSet="/static/e9127b8e576402d43e65260030c6fa43/d824c/ghost.png 27w,/static/e9127b8e576402d43e65260030c6fa43/fa736/ghost.png 55w,/static/e9127b8e576402d43e65260030c6fa43/0d876/ghost.png 109w,/static/e9127b8e576402d43e65260030c6fa43/8971a/ghost.png 218w" alt="Progress Image"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></a></div><a class="h-full flex items-end" href="/"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained w-9 -ml-4 mr-2 drop-shadow-md"><div style="max-width:150px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;171&#x27; width=&#x27;150&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEdklEQVQ4y82US1BbVRjHT8CN7aIL3flc2XFGN7qo2k2nrbTjECDlkcmDgFAShLaUgOWVS3mFQBKEQiAEGyAJhLxDIIYkEGibhmchCYhjbbEu2y50dLQLcrmfcw5QdXRauvPO/Oc7c+fO7/7POd//QwghlJ4uRBcu1iCxpAKJRKWIz5egN15/95hYLB2iKOUftXWKh7V1ikcyqv33vLwLXa++8vb7XO558m1BYRmSFFeiU6fSEXnOnctDEkklys4uYGVm5qPc3JIPeDzxULdm+Mm4JwTzixsQjsSI5hfXweEKgLpD93MOt7A3N7fkHR5PjHg8MSsr63OUkZG7Czx7NpvAAQCVlcmWJrxzEJpb2rHZv6E1vYOMVmdktP1GRtM3xDjdATo0twxOVxCKi7/0G4xutPXgMevo0Q//AkorribhP3A4Iv51vXV7OrSwoxsY2Zn0zsGdtbvM4vIms7TyHYPXLncQvtab6QlvCOStXU9Onsw489GxTxGXW8jCR0eAVL0yuVxaj4TCLywzoSXQD44lgjPzEFvfYsKRGOMa98O4J4C3z8Q3fmQmvLPQ3TOwrRswApst6ExLEyI+X5z81KGMak8qK5MhgbB40B+IgMHooH3+W8xa7D7cno+DecwFFus4LC5vwlrsHrg900yfdjDRpx0GNpsvZ7P5iPcv4GUCHPYHI2AwORKeyRDj9c2Cyz1FYBarB7BT39QNcLr8BKjtJ0AFmy14NtBocibcniBYbR4YGXUQ4JjFDaYRO9gdk2B3ToG2fyih1R4QaDA6El7fDQjfXoPgTIQAMXxmdgHCkSg43QHo7dMf1OE8DBvtialAGKLxLYgsxAnQZp8gZxjfeACmURe0yFUJ3YAJUlN5BwP6/LdgNfoDcUQc2icgsrAO0fUtMJic0NTclhh4MWAYVqP3SEL2HeLUxNa3wDiCge0v6vD/CBT+JzBKWgbf8vOAHI4IIZxhqfRqckVFw9O2GTbsXsqdtbsEMndzhQivo/H7e5eCgUZITeW34aRwued3gSkpmSw8ZfDoEolKB3GWTaOu/SwTKI4b1srq97Cx+ROMmt2kba7rRyEtTdBy4kQanlSslJQsFvrk4zN4ch1GCL2cni40W20+6O7R02bLJARnFgBvfV8453M3V6FPa4Dqmgb6q85+OH2a041Q0pFDh147fPz4Zwi99eZ7R6pr5MGGxo6HMqr9V3lrNzQ1dzIt8mugaNNAq6KHCL+vkylAJlNAVVUTVFbWM1eqGqHsct1vUin1S0nJFQdC6CU8AxdlVDt0XdODumMAVGodo+7Q4Qoqdf+edKBUaYGi2ggQV6q+DShKweDa0KiEi5dqgMMRuVFNbSvt9kwnxiyTCYvVS1ts3h2LjVTaulf31zaHj3a4ArTR5KKVqh5apdbsqNQaWqnSbHd29YNEIn2EqqqbwOX2kT4jk+QZwt84nF4YHDJDbV0zyCj5P5SfX/oYCQSSZbG4PF5UVB4tKiqPPU9icXmsoOBSTCCQ/F1RgUDybU5OQfBPrUkpZaI09W4AAAAASUVORK5CYII=" alt=""/><picture><source type="image/webp" data-srcset="/static/26dc7b21275899ad3a53ee1240a0494e/8c86a/grave.webp 38w,/static/26dc7b21275899ad3a53ee1240a0494e/21236/grave.webp 75w,/static/26dc7b21275899ad3a53ee1240a0494e/2b3c0/grave.webp 150w,/static/26dc7b21275899ad3a53ee1240a0494e/0edb4/grave.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" data-src="/static/26dc7b21275899ad3a53ee1240a0494e/faeed/grave.png" data-srcset="/static/26dc7b21275899ad3a53ee1240a0494e/4a48e/grave.png 38w,/static/26dc7b21275899ad3a53ee1240a0494e/000a1/grave.png 75w,/static/26dc7b21275899ad3a53ee1240a0494e/faeed/grave.png 150w,/static/26dc7b21275899ad3a53ee1240a0494e/7abe6/grave.png 300w" alt="Progress Image"/></picture><noscript><picture><source type="image/webp" srcSet="/static/26dc7b21275899ad3a53ee1240a0494e/8c86a/grave.webp 38w,/static/26dc7b21275899ad3a53ee1240a0494e/21236/grave.webp 75w,/static/26dc7b21275899ad3a53ee1240a0494e/2b3c0/grave.webp 150w,/static/26dc7b21275899ad3a53ee1240a0494e/0edb4/grave.webp 300w" sizes="(min-width: 150px) 150px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 150px) 150px, 100vw" decoding="async" loading="lazy" src="/static/26dc7b21275899ad3a53ee1240a0494e/faeed/grave.png" srcSet="/static/26dc7b21275899ad3a53ee1240a0494e/4a48e/grave.png 38w,/static/26dc7b21275899ad3a53ee1240a0494e/000a1/grave.png 75w,/static/26dc7b21275899ad3a53ee1240a0494e/faeed/grave.png 150w,/static/26dc7b21275899ad3a53ee1240a0494e/7abe6/grave.png 300w" alt="Progress Image"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></a></div><main><div class="w-full h-72 md:h-96"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained !absolute -z-10 w-full h-72 md:h-96 object-cover brightness-50 bg-white"><div style="max-width:1057px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;1016.0000000000001&#x27; width=&#x27;1057&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/jpeg;base64,/9j/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wgARCAATABQDASIAAhEBAxEB/8QAGgABAQACAwAAAAAAAAAAAAAAAAgEBQYHCf/EABcBAQADAAAAAAAAAAAAAAAAAAcFBgj/2gAMAwEAAhADEAAAAeu6c0+GGsHh4stfpfitMiSAxwBne/8A/8QAGxAAAgMBAQEAAAAAAAAAAAAABQYDBAcCART/2gAIAQEAAQUCxjGFAoosaPkJoWZTSQ8lnTmu+K0JTP1K2dL3ZSdCTuQUIrV+0g/719n/xAAlEQACAgEEAQMFAAAAAAAAAAACAwEEBQYREhQiABMxFSEjJDP/2gAIAQMBAT8BtIio8qYoWA1rdocnUSUgzHrf5l1gWToDsrYQrEZjdcrkSYLImLGldIEyDvrzIXGKrtsxj6+Pt0ic2uphsrWfrVaHLdJe7BikA8/DkMQZaut2qmqcyNWzYrDcBPbGu5iRtb4VVuexCyGHb2oiz+Tl+xEO/p5eqeOx51wI6NM55NHcqySniDTAB3kPgAERGPgRGBj7RHr/xAAkEQACAQIFBQEBAAAAAAAAAAABAgMEBRESEyExABQiIzIkUf/aAAgBAgEBPwGVrrU3Gpnq5r+KlZs9ppqOGWWknVZEFMe4fLTlVGLtJJEUOlIJshXSaG63URoulESoynPrKwZdmUr274ZGxT6JwG+B2FriiltNEZY0kMTDSLormP8AbpessDk9Xr8cPDw+dunllDbSScKftuSoJPPJJxP9PX//xAAmEAACAgEEAgIBBQAAAAAAAAACAwEEBQYREhMUIQAiIxUxQUJR/9oACAEBAAY/Ak6w1Mi/YixZsXEVRtMCkdHHL6wsdVRfnnMvi9MKVY5NiADrP6jLNG49OLwtq8Fm2m9goTF2lcrpRt+ofcrtgSBwFYx9gTEVpZNjw7ApIrWOYKvIxzTx9nrP6d9IyrGUbxvENhQtHf8AqcT/AD8RpfUeTqYd9aZsV3zAU8e+tkWsyAqA+M1Kx132bCPDsSHKuKHK7Y58X3x1Ld1hQx1FdXSGlh8zIhgvqcZOxStOkMYpWTZE9mU4KiKxMFj7gQmBtZJVisg825+Yth4faMW7lh3aK5MlmIK6xRAkPL8UnO3PaMcwzIjOjTMymfZH1GrkX+lIJVEzPueETPvefmYtMQptgQyygc5YuNS6dihFcUSyC6OEWn79PCWc/wAnPgHFIQRwK6FEQETIYiCQLJ/aY33NhlMz73n5/8QAGRABAQEBAQEAAAAAAAAAAAAAAREAITFR/9oACAEBAAE/IXSN2cMeZEDtc+p+WxkbLY1kXlev6MuRCAsc0Mr8tgVUK3hVtw2imVE5jgMS8P8AffLMQqSAltazpm6N9m6orScSnEmSiFxF4jci0Cb7lyEtZA//2gAMAwEAAgADAAAAEPcXvf/EABgRAQEBAQEAAAAAAAAAAAAAAAERACFB/9oACAEDAQE/EHLWGmIxAJNKqABftEqlLMWZp7XSUhmFE2hyAEJAejBb2HhUEf/EABkRAQADAQEAAAAAAAAAAAAAAAEAESExYf/aAAgBAgEBPxDKam5FdjhYZdHEBTsHMqQ0BAMPY74QwNHbV6RTBCygtXVpBOorarP/xAAZEAEBAQEBAQAAAAAAAAAAAAABABExECH/2gAIAQEAAT8Qibrbq5WZ9IFc2p+3QQpTJXpSAeJyxkBfhG70guyaJ59dW1A0FCAXO7+wS0TTzn8tuyTAYgWxuoU4sOCtRBUn4ICsQKG4YsE+qH0in//Z" alt=""/><picture><source type="image/webp" data-srcset="/static/6a3b9dce28b4687f9f583de058b08be4/c5924/choonsik_jenkins.webp 264w,/static/6a3b9dce28b4687f9f583de058b08be4/d0e04/choonsik_jenkins.webp 529w,/static/6a3b9dce28b4687f9f583de058b08be4/8470c/choonsik_jenkins.webp 1057w" sizes="(min-width: 1057px) 1057px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1057px) 1057px, 100vw" decoding="async" loading="lazy" data-src="/static/6a3b9dce28b4687f9f583de058b08be4/cad72/choonsik_jenkins.jpg" data-srcset="/static/6a3b9dce28b4687f9f583de058b08be4/263a2/choonsik_jenkins.jpg 264w,/static/6a3b9dce28b4687f9f583de058b08be4/ac426/choonsik_jenkins.jpg 529w,/static/6a3b9dce28b4687f9f583de058b08be4/cad72/choonsik_jenkins.jpg 1057w" alt="thumbnail"/></picture><noscript><picture><source type="image/webp" srcSet="/static/6a3b9dce28b4687f9f583de058b08be4/c5924/choonsik_jenkins.webp 264w,/static/6a3b9dce28b4687f9f583de058b08be4/d0e04/choonsik_jenkins.webp 529w,/static/6a3b9dce28b4687f9f583de058b08be4/8470c/choonsik_jenkins.webp 1057w" sizes="(min-width: 1057px) 1057px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1057px) 1057px, 100vw" decoding="async" loading="lazy" src="/static/6a3b9dce28b4687f9f583de058b08be4/cad72/choonsik_jenkins.jpg" srcSet="/static/6a3b9dce28b4687f9f583de058b08be4/263a2/choonsik_jenkins.jpg 264w,/static/6a3b9dce28b4687f9f583de058b08be4/ac426/choonsik_jenkins.jpg 529w,/static/6a3b9dce28b4687f9f583de058b08be4/cad72/choonsik_jenkins.jpg 1057w" alt="thumbnail"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><div class="flex flex-col w-full md:w-[725px] lg:w-[840px] h-full my-0 mx-auto py-10 px-5 md:py-14 md:px-0 text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class=" grid place-items-center w-7 h-7 md:w-10 md:h-10 text-white cursor-pointer"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.707-10.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L9.414 11H13a1 1 0 100-2H9.414l1.293-1.293z" clip-rule="evenodd"></path></svg><div class=" overflow-hidden break-words mt-auto text-ellipsis whitespace-normal line-clamp-2 text-2xl md:text-5xl font-bold">Jenkins를 이용한 CI/CD 파이프라인 구축 4</div><div class="flex justify-between items-start md:items-center mt-4 text-base md:text-lg font-normal md:font-semibold"><div>jenkins</div><div>2023.07.30.</div></div></div></div><style data-emotion="css q7fpjh">.css-q7fpjh{line-height:1.8;font-size:16px;font-weight:400;}.css-q7fpjh p{padding:3px 0;margin-top:0;margin-bottom:10px;}.css-q7fpjh p,.css-q7fpjh blockquote,.css-q7fpjh ul,.css-q7fpjh ol,.css-q7fpjh dl,.css-q7fpjh table,.css-q7fpjh pre,.css-q7fpjh details{margin-top:0;margin-bottom:8px;}.css-q7fpjh h1,.css-q7fpjh h2,.css-q7fpjh h3{font-weight:800;margin-bottom:5px;}.css-q7fpjh *+h1,.css-q7fpjh *+h2,.css-q7fpjh *+h3{margin-top:25px;}.css-q7fpjh hr+h1,.css-q7fpjh hr+h2,.css-q7fpjh hr+h3,.css-q7fpjh h2+h3{margin-top:0;}.css-q7fpjh h1{font-size:30px;border-bottom:1px solid #d9dee3;}.css-q7fpjh h2{font-size:25px;border-bottom:1px solid #d9dee3;}.css-q7fpjh h3{font-size:20px;}.css-q7fpjh blockquote{margin:15px 0;padding:2px 14px;border-left:4px solid #bdbdbd;font-style:italic;color:#6e6e6e;}.css-q7fpjh blockquote>:last-child{margin-bottom:0;}.css-q7fpjh ol{margin-left:24px;padding:8px 0;list-style-type:decimal;}.css-q7fpjh ul{margin-left:20px;padding:8px 0;list-style-type:disc;}.css-q7fpjh table{display:block;width:100%;overflow:auto;padding:8px 0;}.css-q7fpjh table th{font-weight:600;background-color:#778899;}.css-q7fpjh table td,.css-q7fpjh table th{padding:6px 13px;border:1px solid #dfe2e5;}.css-q7fpjh table tr{background-color:#fff;border-top:1px solid #c6cbd1;}.css-q7fpjh table tr:nth-child(2n){background-color:#f6f8fa;}.css-q7fpjh hr{border:1px solid #000000;margin:100px 0;}.css-q7fpjh a{color:#4263eb;-webkit-text-decoration:underline;text-decoration:underline;}.css-q7fpjh .language-text{padding:2px 4px;margin:0px 2px;background:#e9e9e9;color:#f00;font-size:14px;border-radius:0.25rem;}</style><div class="flex flex-col w-auto md:w-[725px] lg:w-[840px] mx-3 sm:mx-auto my-0 py-14 px-5 md:py-16 md:px-0 break-all css-q7fpjh e1ijh0y10"><blockquote>
<p><strong>k8s와 연동하기</strong></p>
</blockquote>
<h2>k8s 설치하기</h2>
<p>k8s란 쿠버네티스의 약자로 도커같은 컨테이너들을 오케스트레이션 해주는 도구입니다.</p>
<p>k8s를 연동하기 전에 먼저 k8s를 설치해야겠죠?</p>
<p>k8s를 설치하는 방법이나 문서는 너무 많기 때문에 생략하고 개인적으로 k8s를 설치하면서 겪은 문제 과정들을 공유하도록 하겠습니다.</p>
<h3>서론</h3>
<p>강의에선 로컬에 k8s를 싱글노드로 달았지만 <strong>멀티노드 클러스터</strong>를 꼭 만들어보고 싶어서 오라클 서버 2대에 적용해봤습니다.</p>
<blockquote>
<p>하지만 쉽지않은 길이었습니다… ㅠㅠ</p>
</blockquote>
<h3>삽질기</h3>
<ol>
<li><strong>오라클 서버의 메모리 부족</strong>
<ul>
<li>기본적으로 k8s는 1700MB 이상의 램을 요구합니다. 따라서 오라클에서 무료로 제공하는 서버(메모리 1기가)로는 애초에 k8s를 띄울 수 없었습니다.</li>
</ul>
</li>
<li><strong>m1 mac에서 k8s 마스터 구동 불가.</strong>
<ul>
<li>그래서 램이 넉넉한 로컬에서 k8s 마스터를 띄워보려 했지만 맥에선 구동이 안되더라구요…</li>
</ul>
</li>
<li><strong>오라클 서버 기본 OS : centOS</strong>
<ul>
<li>메모리가 부족했기에 경량화 k8s인 <strong>k3s</strong>를 사용해보려 했는데, k3s가 ubuntu만 지원했습니다… 우쒸 결국 클라우드 서버 다 닫고 ubuntu로 새로 열었습니다…</li>
</ul>
</li>
<li><strong>포트 안엶.</strong>
<ul>
<li>
<p>k8s는 6443 포트가 꼭 열려있어야 하는데, 바보같이 클라우드 설정에서만 열어뒀습니다. 아래처럼 OS의 iptable도 갱신해줘야 하더라구요.</p>
<img width="400" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/8e94a961-9262-488e-a461-f2b56bf8b99a">
</li>
</ul>
</li>
</ol>
<h3>성공 !</h3>
<img width="400" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/29c376d6-fc95-4fd4-9f44-29d9421ea670">
<h3>구조도</h3>
<img width="400" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/3b1e1db2-2e5d-4243-a5c7-75bb4c81f12e">
<h1>Jenkins + Ansible + k8s</h1>
<img width="400" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/e52e2fec-abe9-483c-bc59-0d00b75f610f">
<p>개인 공부 환경 [전체 구조]</p>
<h3>Ansible로 k8s에 deploy 하기</h3>
<p>먼저 <code class="language-text">springio</code>에서 제공해주는 <code class="language-text">sample-spring</code> 이미지를 k8s에 올려보겠습니다.</p>
<ul>
<li>
<p>k8s deployment, service</p>
<pre class="grvsc-container default-dark" data-language="yaml" data-index="0"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">kind</span><span class="mtk1">: </span><span class="mtk8">Deployment</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">metadata</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">cicd-deployment</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">spec</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">selector</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">matchLabels</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">app</span><span class="mtk1">: </span><span class="mtk8">cicd-devops-project</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">replicas</span><span class="mtk1">: </span><span class="mtk7">2</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">template</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">metadata</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">labels</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">app</span><span class="mtk1">: </span><span class="mtk8">cicd-devops-project</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">spec</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">containers</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      - </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">cicd-devops-project</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">image</span><span class="mtk1">: </span><span class="mtk8">springio/gs-spring-boot-docker</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">imagePullPolicy</span><span class="mtk1">: </span><span class="mtk8">Always</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">ports</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        - </span><span class="mtk4">containerPort</span><span class="mtk1">: </span><span class="mtk7">8080</span></span></span></code></pre>
<pre class="grvsc-container default-dark" data-language="yaml" data-index="1"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">apiVersion</span><span class="mtk1">: </span><span class="mtk8">v1</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">kind</span><span class="mtk1">: </span><span class="mtk8">Service</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">metadata</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">cicd-service</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">labels</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">app</span><span class="mtk1">: </span><span class="mtk8">cicd-devops-project</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk4">spec</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">selector</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">app</span><span class="mtk1">: </span><span class="mtk8">cicd-devops-project</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">type</span><span class="mtk1">: </span><span class="mtk8">NodePort</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">ports</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    - </span><span class="mtk4">port</span><span class="mtk1">: </span><span class="mtk7">8080</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">targetPort</span><span class="mtk1">: </span><span class="mtk7">8080</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">nodePort</span><span class="mtk1">: </span><span class="mtk7">32000</span></span></span></code></pre>
</li>
</ul>
<p>이미지를 올렸다면, 이제 ansible playbook을 이용해 k8s deployment와 service를 배포해보겠습니다.</p>
<pre class="grvsc-container default-dark" data-language="yaml" data-index="2"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">- </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">Create pods using deployment</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">hosts</span><span class="mtk1">: </span><span class="mtk8">k8s</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3"># become: true</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3"># user: ubuntu</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">tasks</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  - </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">delete the previous deployment</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">command</span><span class="mtk1">: </span><span class="mtk8">kubectl delete deployment.apps/cicd-deployment</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">ignore_errors</span><span class="mtk1">: </span><span class="mtk4">True</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  - </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">create a deployment</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">command</span><span class="mtk1">: </span><span class="mtk8">kubectl apply -f cicd-devops-deployment.yml</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">args</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">chdir</span><span class="mtk1">: </span><span class="mtk8">/home/ubuntu/k8s</span></span></span></code></pre>
<pre class="grvsc-container default-dark" data-language="yaml" data-index="3"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">- </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">create service for deployment</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">hosts</span><span class="mtk1">: </span><span class="mtk8">k8s</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3"># become: true</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk3"># user: ubuntu</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">tasks</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  - </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">create a service</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">command</span><span class="mtk1">: </span><span class="mtk8">kubectl apply -f cicd-devops-service.yml</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">args</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">chdir</span><span class="mtk1">: </span><span class="mtk8">/home/ubuntu/k8s</span></span></span></code></pre>
<img width="600" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/4a3fc7f6-1f87-4bc1-8c5d-a40c73316cb3">
<p>cicd-deployment가 잘 올라가있는것을 볼 수 있습니다.</p>
<blockquote>
<p>위 툴은 k9s라는 툴입니다.</p>
</blockquote>
<blockquote>
<p>허약한 오라클 서버의 스펙으론 마스터 노드를 버티기 힘들었는지 자꾸 죽어나갔습니다…</p>
<img width="600" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/cc4412bb-2bea-4caf-8d38-ad963b3eddef">
</blockquote>
<blockquote>
</blockquote>
<p>이번엔 service를 올려보겠습니다.</p>
<img width="500" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/6391a714-80df-4131-8e1d-708041f2fbe5">
<p>그러고 나면 아래와 같이 32000포트에 sample spring 애플리케이션이 잘 열린걸 볼 수 있습니다.</p>
<img width="400" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/18a513b1-a6fc-4b25-a6ba-5a5d5f012952">
<h3>이 과정을 Jenkins에 얹어서 진행해보기</h3>
<p>위에서 수동으로 진행했던 과정을 jenkins에 그대로 올려주면 되서 과정 자체는 간단합니다.</p>
<p>그저 빌드 후 명령어에 <code class="language-text">ansible-playbook deployment</code>, <code class="language-text">service</code>만 넣어주면 끝입니다.</p>
<img width="500" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/a5a956a4-5dd4-4fcd-acb3-7d46655f4274">
<h2>Docker를 얹어서 내 애플리케이션 올려보기</h2>
<p><code class="language-text">playbook.yml</code>은 아래와 같습니다.</p>
<pre class="grvsc-container default-dark" data-language="yaml" data-index="4"><code class="grvsc-code"><span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">- </span><span class="mtk4">hosts</span><span class="mtk1">: </span><span class="mtk8">devops[0]</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk3">#   become: true</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  </span><span class="mtk4">tasks</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  - </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">Copying jar from ansible server to devops server</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">copy</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">src</span><span class="mtk1">: </span><span class="mtk8">&quot;/root/jenkins-study-0.0.1-SNAPSHOT.jar&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">dest</span><span class="mtk1">: </span><span class="mtk8">&quot;/home/ubuntu/docker&quot;</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  - </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">login into DockerHub if not login</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">docker_login</span><span class="mtk1">:</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">username</span><span class="mtk1">: </span><span class="mtk15">*</span><span class="mtk12">***</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">      </span><span class="mtk4">password</span><span class="mtk1">: </span><span class="mtk15">*</span><span class="mtk12">***</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  - </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">create a docker image with deployed waf file</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">command</span><span class="mtk1">: </span><span class="mtk8">docker build --platform linux/amd64 -t gusah009/cicd-project-ansible .</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">args</span><span class="mtk1">: </span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">        </span><span class="mtk4">chdir</span><span class="mtk1">: </span><span class="mtk8">/home/ubuntu/docker</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  - </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">push the image on Docker Hub</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">command</span><span class="mtk1">: </span><span class="mtk8">docker push gusah009/cicd-project-ansible</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">  - </span><span class="mtk4">name</span><span class="mtk1">: </span><span class="mtk8">remove the docker image from the ansible server</span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">command</span><span class="mtk1">: </span><span class="mtk8">docker rmi gusah009/cicd-project-ansible</span><span class="mtk1">  </span></span></span>
<span class="grvsc-line"><span class="grvsc-source"><span class="mtk1">    </span><span class="mtk4">ignore_errors</span><span class="mtk1">: </span><span class="mtk4">yes</span></span></span></code></pre>
<p>각 부분에 대한 설명)</p>
<ul>
<li><code class="language-text">hosts: devops[0]</code> :  docker image 빌드를 여러곳에서 할 필요 없으니 한 곳에서만 하도록 설정</li>
<li><code class="language-text">tasks.copy</code> : jenkins에서 빌드되어 ansible 서버로 온 jar 파일을 다시 docker build할 곳으로 넘겨준다.</li>
<li><code class="language-text">tasks.docker_login</code> : docker hub에 docker image를 올려야 하기 때문에 로그인을 해준다.</li>
<li><code class="language-text">tasks.docker_build</code> : 도커 빌드</li>
<li><code class="language-text">tasks.docker_image_push</code> : 만들어진 도커 이미지를 docker hub에 올린다.</li>
<li><code class="language-text">tasks.docker_rmi</code> : docker hub에 올렸으면 방금 만든 이미지는 삭제한다.</li>
</ul>
<h3>애플리케이션 올리기</h3>
<p>도커 이미지를 빌드해서 docker hub에 올렸다면 그 이미지를 받아서 위의 deployment, service를 갱신해주는 작업을 하면 됩니다.</p>
<p>그럼 아래처럼 나의 애플리케이션 파일이 배포되어 있는걸 볼 수 있습니다.</p>
<img width="200" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/e7aae591-0265-4941-b7d0-af144242cf8e">
<img width="300" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/097116e4-5ba5-4566-a902-54818d06f0cd">
<hr>
<blockquote>
<p>*오라클 서버가 너무 느려서 봤더니 <strong>메모리 사용량이 계속 80~90%</strong> 가 찍히고 있었습니다…</p>
</blockquote>
<p>이유는 스왑 메모리를 사용하고 있지 않아서 였는데, k8s를 사용하면 기본적으로 스왑 메모리를 사용하지 않도록 합니다.
이유는 k8s가 노드들의 리소스를 확인하고 적절한 곳에 파드를 분배해야 하는데 스왑 메모리가 켜져있으면 파드의 현재 리소스를 파악할 수 없기 때문입니다.
<strong>하지만 저는 개발용으로 사용중이어서 그냥 스왑 메모리를 켜버렸습니다.</strong>*</p>
<blockquote>
<img width="550" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/72d67dd1-20c8-4a0c-80bd-fd52e4f8705e">
<p><em>before</em></p>
<img width="55  0" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/c7ac8d78-edc3-4905-be7a-ba6d98a94f29">
<p><em>after</em></p>
<img width="500" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/d1e77c3d-83fc-47af-b6a4-192daa503b9a">
<p>메모리 사용량이 뚝 떨어진걸 볼 수 있습니다. (그 와중에 또 서버가 죽어서 metric 공백이 생겼네요…)</p>
<img width="500" alt="image" src="https://github.com/KEEPER31337/Homepage-Back-R2/assets/26597702/a58e99d0-4c49-4dd9-9003-3c88f6e71154">
<p>속시원</p>
</blockquote>
<h2>ref</h2>
<p><a href="https://www.inflearn.com/course/%EC%A0%A0%ED%82%A8%EC%8A%A4-ci-cd-%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8/dashboard" target="_blank" rel="nofollow">Jenkins를 이용한 CI/CD Pipeline 구축 - 인프런 | 강의</a></p>
<style class="grvsc-styles">
  .grvsc-container {
    overflow: auto;
    position: relative;
    -webkit-overflow-scrolling: touch;
    padding-top: 1rem;
    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));
    padding-bottom: 1rem;
    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));
    border-radius: 8px;
    border-radius: var(--grvsc-border-radius, 8px);
    font-feature-settings: normal;
    line-height: 1.4;
  }
  
  .grvsc-code {
    display: table;
  }
  
  .grvsc-line {
    display: table-row;
    box-sizing: border-box;
    width: 100%;
    position: relative;
  }
  
  .grvsc-line > * {
    position: relative;
  }
  
  .grvsc-gutter-pad {
    display: table-cell;
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  .grvsc-gutter {
    display: table-cell;
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter::before {
    content: attr(data-content);
  }
  
  .grvsc-source {
    display: table-cell;
    padding-left: 1.5rem;
    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));
    padding-right: 1.5rem;
    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));
  }
  
  .grvsc-source:empty::after {
    content: ' ';
    -webkit-user-select: none;
    -moz-user-select: none;
    user-select: none;
  }
  
  .grvsc-gutter + .grvsc-source {
    padding-left: 0.75rem;
    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);
  }
  
  /* Line transformer styles */
  
  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {
    content: ' ';
    position: absolute;
    width: 100%;
  }
  
  .grvsc-line-diff-add::before {
    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));
  }
  
  .grvsc-line-diff-del::before {
    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));
  }
  
  .grvsc-line-number {
    padding: 0 2px;
    text-align: right;
    opacity: 0.7;
  }
  
  .default-dark {
    background-color: #1E1E1E;
    color: #D4D4D4;
  }
  .default-dark .mtk4 { color: #569CD6; }
  .default-dark .mtk1 { color: #D4D4D4; }
  .default-dark .mtk8 { color: #CE9178; }
  .default-dark .mtk7 { color: #B5CEA8; }
  .default-dark .mtk3 { color: #6A9955; }
  .default-dark .mtk15 { color: #C586C0; }
  .default-dark .mtk12 { color: #9CDCFE; }
  .default-dark .grvsc-line-highlighted::before {
    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));
    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));
  }
</style></div><div class="py-0 px-5 md:p-0  md:w-[725px] lg:w-[840px] mx-auto"></div><footer class=" grid place-items-center mt-auto p-12 text-xs md:text-sm text-center leading-6 text-gray-600">Thank You for Visiting My Blog, Have a Good Day 😆<br/>© 2022 정현모, Powered By Gatsby.</footer></main></div></div></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/cicd/jenkins/2023-07-30-Jenkins를 이용한 CICD 파이프라인 구축 4/";window.___webpackCompilationHash="e8fdeb6db5b225a725bc";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-c857dff8cba8f79dec61.js"],"app":["/app-685314128435bcfb57a1.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-1412a1274f0f9067667f.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-1c39fcaf757a409e2dc2.js"],"component---src-templates-post-template-tsx":["/component---src-templates-post-template-tsx-9a9068661456bbe1688f.js"]};/*]]>*/</script><script src="/polyfill-c857dff8cba8f79dec61.js" nomodule=""></script><script src="/app-685314128435bcfb57a1.js" async=""></script><script src="/framework-9a7e817db04652ee5936.js" async=""></script><script src="/webpack-runtime-4bc39b3c04f394855ef0.js" async=""></script></body></html>