---
title: "[item55] 옵셔널 반환은 신중히 하라"
toc_label: "[item55]"
toc: false
toc_sticky: false
---

> **옵셔널 반환은 신중히 하라**

`Java8` 이전에는 메서드가 **특정 조건에서 값을 반환할 수 없을 때** 예외를 던지거나 `null`을 반환함으로써 그 의미를 전달했습니다.

하지만 예외는 **반드시 예외적인 상황에서만** 던지는 것이 올바릅니다. 또, **예외 스택을 모두 캡처**해야 함으로 비용도 만만치 않습니다.

`null`을 반환하는 것 역시 앞 장에서 보았듯이 많은 문제가 있습니다.

## Optional
`Java8`부터 `Optional`이 생겨 값을 반환할 수 없을 때의 표현을 `null`이 아닌 객체로 할 수 있게 됐습니다.

`Optional`을 반환값으로 사용한다면 클라이언트는 해당 반환값이 `null`일 수도 있다는 합리적인 추측이 가능합니다. 이에 맞게 `null` 관련 처리 코드를 작성할 수 있고, `Optional`이 아닌 반환값은 `null`로 반환되지 않음을 보장받을 수 있습니다.

## Optional을 사용하면 안되는 경우
### 컨테이너 타입
앞 장에서 살펴봤듯이 **컬렉션, 스트림, 배열, 옵셔널**같은 컨테이너 타입은 옵셔널로 감싸는 것 보다 빈 컨테이너를 반환하는 것이 좋습니다. 

빈 컨테이너를 그대로 반환하면 클라이언트에 옵셔널 처리 코드를 넣지 않아도 된다는 장점이 있습니다.
### 성능이 중요한 상황
결국 `Optional`도 하나의 객체이기 때문에 초기화 하는 비용과, 값을 꺼내기 위해 메서드를 호출하는 비용을 생각하면 성능에 영향을 미칠 수 있습니다.

그래서 성능이 중요한 상황에서는 `Optional`이 맞지 않을 수 있습니다.

## 기본타입 Optional
박싱된 기본 타입의 `Optional`을 방식해서 사용할 수도 있지만, 자바에서는 `OptionalInt`, `OptionalLong`, `OptionalDouble`과 같은 기본 타입 전용 클래스를 만들어 놨습니다. **따라서 박싱된 기본 타입을 담은 `Optional`은 사용하지 않는 것이 좋습니다.**


