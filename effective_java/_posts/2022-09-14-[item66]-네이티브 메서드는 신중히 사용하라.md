---
title: "[item66] 네이티브 메서드는 신중히 사용하라"
toc_label: "[item66]"
toc: false
toc_sticky: false
---

> **네이티브 메서드는 신중히 사용하라**

`Java`는 기본적으로 `C`나 `C++`같은 네이티브 언어를 기반으로 만들어진 언어입니다. 

`Java`에서도 **플랫폼에 특화한 기능**이나, **네이티브 코드로 작성된 기존 라이브러리를 사용**할 때, **성능을 향상**시키고자 할 때 네이티브 언어로 개발하는데, 이를 **JNI(Java Native Interface)**라고 부릅니다.

이번 장에서는 `Java`가 발전하면서 네이티브 메서드의 변화점에 대해 알아보겠습니다.

## 플랫폼 특화 기능
플랫폼에 특화된 기능을 사용하려면 네이티브 언어를 사용해야 합니다.

`Java9`에 들어서면서 새로운 `process API`를 추가하여 OS 프로세스에 접근하는 길을 열어줬지만, 여전히 **대체할만한 자바 라이브러리가 없는 네이티브 라이브러리를 사용해야 할 때에는 네이티브 메서드를 사용**해야 합니다.

## 성능 향상
**더 이상 성능을 향상시킬 목적으로 네이티브 메서드를 사용하는 것은 거의 권장하지 않습니다.**

과거와 달리 `JVM`이 끊임없이 발전해오면서 대부분의 작업에서 지금의 자바는 다른 플랫폼에 견줄만한 성능을 보입니다.

한 예로, `BigInteger`는 과거에 `C`로 작성한 고성능 라이브러리에 의지했었지만, 현재는 순수 자바로 구현되었고 세심히 튜닝한 결과 심지어 원래의 네이티브 구현보다도 빨라졌습니다.

### GNU 다중 정밀 연산 라이브러리
한편, 네이티브 라이브러리 중 **다중 정밀 연산 라이브러리(GMP)**는 계속해서 개선 작업이 이루어졌습니다.

그래서 **정말 고성능의 다중 정밀 연산이 필요하다면** 네이티브 메서드를 통해 GMP 사용을 고려해볼 수 있습니다.

## 네이티브 메서드의 단점

1. 네이티브 언어는 GC대상이 아니므로 메모리 훼손 오류로부터 안전하지 않습니다.

2. 또, 네이티브 언어는 자바보다 플랫폼에 종속적이기 때문에 이식성도 낮습니다.

3. 디버깅도 어려울뿐더러, 주의하지 않으면 속도가 더 느려질 수 있습니다.

## 결론
더 이상 네이티브 메서드가 성능을 개선해주는 경우는 많지 않습니다.

저수준 자원이나 네이티브 라이브러리를 사용해야만 해서 어쩔 수 없이 사용한다 하더라도, **철저히 테스트하고 주의**하도록 합시다.