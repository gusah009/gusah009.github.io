---
date: '2022-09-05'
title: '[item61] 박싱된 기본 타입보다는 기본 타입을 사용하라'
categories: ['effective_java']
summary: '`Java`에선 기본 타입(primitive type)과 박싱된 기본 타입을 제공합니다. 두 타입의 차이는 힙에 배치되느냐, 스택에 배치되느냐의 차이 외에도 래핑된 타입은 결국 클래스이기 때문에 여러 부가기능을 제공해 줄 수 있습니다.'
thumbnail: './effective_java_thumb.png'
---

> **박싱된 기본 타입보다는 기본 타입을 사용하라**

`Java`에선 기본 타입(primitive type)과 박싱된 기본 타입을 제공합니다. 두 타입의 차이는 **힙에 배치되느냐, 스택에 배치되느냐**의 차이 외에도 래핑된 타입은 결국 클래스이기 때문에 여러 부가기능을 제공해 줄 수 있습니다.

`Java`는 언어차원에서 기본 타입과 박싱된 기본 타입이 서로 호환될 수 있도록 **오토박싱과 오토언박싱**을 지원합니다. 하지만 이런 오토박싱, 언박싱이 장점만 가져다 주진 않았습니다. 

이번 장에서는 왜 기본타입을 우선적으로 사용해야 하는 지에 대해 알아보겠습니다.

## 기본 타입과 박싱된 기본 타입의 차이
### 식별성
기본 타입은 **값만 같으면 같은 값**으로 봅니다. 하지만 박싱된 기본 타입은 사실상 클래스이기 때문에 **두 인스턴스 값이 같아도 서로 다른 인스턴스로 식별될 수 있습니다.**

```java
System.out.println(new Integer(42) == new Integer(42)); // false
```

위의 코드와 같이 놀랍게도 박싱된 기본 타입은 같은 값임에도 다르다고 식별합니다.

> 그래서 대부분의 API는 기본타입을 사용해야 하는 경우에 박싱된 기본타입을 사용하지 않도록 기본 타입 API를 제공합니다.
>
> 한 예로, `java.util.function`의 `Function`의 경우 `IntFunction`, `LongFunction` 같이 기본 타입 API를 제공합니다.

### `null`
기본 타입은 `null`을 가질 수 없지만 박싱된 기본 타입은 `null`을 가질 수 있습니다.

```java
Integer i = null;

if (i != 3) System.out.println("HI!");
```

위 코드에선 `i`는 당연히 `3`이 아니므로 `HI`를 출력해야 할 것 같지만, 실행시켜보면 `NullPointerException`을 일으킵니다!

이유는 바로 `i`의 초기값이 `null`이라는 데에 있습니다. `Java`는 **기본 타입과 박싱된 기본 타입을 혼용한 연산에서는 박싱된 기본 타입의 박싱이 자동으로 풀립니다.(오토언박싱)** 그렇기 때문에 에러를 일으켰던 것입니다.

해법은 간단합니다. `Integer i` 대신 `int i`로 바꿔주면 됩니다.

### 성능
기본 타입이 박싱된 기본 타입보다 시간, 메모리 사용면에서 더 효율적입니다.

```java
long startTime = System.currentTimeMillis();
Long sum = 0L;
for (long i = 0; i < Integer.MAX_VALUE; i++) {
  sum += i;
}
System.out.println((System.currentTimeMillis() - startTime) / 1000.0 + "s");
```

위 코드를 실행시켜보면 제 PC에서는 `2.657s`가 나옵니다. 매우 느린 것을 확인할 수 있는데, 이유는 바로 **오토언박싱** 때문입니다.

`sum += i`에서 `sum`은 `Long`으로 박싱타입이고, `i`는 `long`으로 기본타입입니다. 이 때문에 오토언박싱이 일어났고, 성능이 끔찍하게 느려진 것입니다.

> 참고로 `sum`을 `long`으로 선언했을 땐 `0.889s`가 나왔고, `i`를 `Long`으로 선언했을 땐 `5.412s`가 나왔습니다. 오토언박싱에 의한 성능저하보다 모두 래핑했을 때 더 성능저하가 심한 것을 확인할 수 있습니다.

## 결론
꼭 박싱된 타입을 써야할 상황이 아니라면 꼭 기본 타입을 사용합시다.
